[{"path":"https://rstudio.github.io/shinytest2/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 shinytest2 authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"customizing-test-scripts","dir":"Articles","previous_headings":"","what":"Customizing test scripts","title":"Testing in depth","text":"test recorder easiest way create test scripts, way. can create edit test scripts manually. final product look something like: test script basic structure: first, initialization, expectations performed. initialization, script creates new AppDriver object. Next, define interactions application makes expectations via snapshots. customizing script, second portion – interactions expectations – part want modify.","code":"# File: ./tests/testthat/test-shinytest2.R test_that(\"App initialization is consistent\", {   app <- AppDriver$new()   app$expect_values() }) app <- AppDriver$new() app$set_inputs(check_group = c(\"1\", \"2\")) app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\") app$expect_values()  app$click(\"action\") app$expect_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"setting-inputs-with-appset_inputs-and-appclick","dir":"Articles","previous_headings":"Customizing test scripts","what":"Setting inputs with app$set_inputs() and app$click()","title":"Testing in depth","text":"app$set_inputs(), provide name one inputs corresponding values set . Consider set directives: Notice set value check_group two times row. recorded test script, started value \"1\", checked \"2\" \"3\" boxes. recorded script set value c(\"1\", \"2\"), c(\"1\", \"2\", \"3\"). c(\"1\", \"2\") value simply intermediate step. possible simplify speed tests dropping intermediate step, leaves us : Multiple calls app$set_inputs() reduced single line unless side effects setting inputs multiple times desired. app$set_inputs() called, normally returns control moves next step server sends response client. reason waits response subsequent call app$snapshot() sure capture updated output values. app$set_inputs() wait update, , output update happen quickly, snapshot might capture state application outputs updated.","code":"app$set_inputs(check_group = c(\"1\", \"2\")) app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\") app$set_inputs(check_group = c(\"1\", \"2\", \"3\")) app$click(\"action\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"making-expectations","dir":"Articles","previous_headings":"Customizing test scripts","what":"Making expectations","title":"Testing in depth","text":"indepth discussion expectations, see Robust testing vignette. couple standard ways make expectations AppDriver object. * app$expect_values(): simplest way make expectation. creates list values compares current values application. also takes debug screenshot stores snapshot. However, snapshot never fail expectation test. extra screenshot file useful manually determining UI changes happened time producing numerous false-positive test failures. * app$expect_screenshot(): method takes screenshot application compares reference screenshot. screenshots different, fails test. ways use app$expect_values(). simplest way call arguments: first time called test script, record input, output, export values application, file called 001.json. next call save values 002.json, . time call app$expect_values(), also save debug screenshot web browser, file 001_.png, 002_.png, . screen shots useful debugging tests inspecting ’re . can tell take screen shots, save space make tests run slightly faster, initialization step, : want disable screenshots single app$expect_values() call, can use: want targeted tests, can snapshot specific items using input, output, export parameters. example, capture value just outputs named \"\" \"b\", call: also capture specific inputs exports: Finally, want snapshot outputs inputs exports, can simply set output TRUE values requested recorded: can used snapshot input /export values. capture output export values, input values:","code":"app$expect_values() app <- AppDriver$new(expect_values_screenshot_args = FALSE) app$expect_values(screenshot_args = FALSE) app$expect_values(output = c(\"a\", \"b\")) app$expect_values(   input = \"n\",   output = c(\"a\", \"b\"),   export = c(\"e1\", \"e2\") ) app$expect_values(output = TRUE) app$expect_values(output = TRUE, export = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"exported-values","dir":"Articles","previous_headings":"Customizing test scripts","what":"Exported values","title":"Testing in depth","text":"cases, ’s useful snapshot bits internal state application – state ’s reflected directly inputs outputs. can done exporting values. Consider toy example application internal reactive expression convenient capture. Notice lines: creates exported values called xy yz. test snapshot taken, evaluates reactive expression inserts values snapshot: Note expression (.e. xy() yz()) saved exportTestValues() called, specific values. Generally, keep expressions simple possible test failures yield informative outputs. Note value serializable JSON, ’s suitable testing complex objects.","code":"shinyApp(   fluidPage(     numericInput(\"x\", \"x\", 4),     numericInput(\"y\", \"y\", 10),     numericInput(\"z\", \"z\", 100),     verbatimTextOutput(\"result\", placeholder = TRUE)   ),   function(input, output, session) {     xy <- reactive(input$x * input$y)     yz <- reactive(input$y + input$z)      output$result <- renderText({       xy() / yz()     })      exportTestValues(       xy = {         xy()       },       yz = {         yz()       }     )   } ) exportTestValues(       xy = {         xy()       },       yz = {         yz()       }     ) {   \"input\": {     \"x\": 4,     \"y\": 10,     \"z\": 100   },   \"output\": {     \"result\": \"0.3636364\"   },   \"export\": {     \"xy\": 40,     \"yz\": 110   } }"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"adding-delays","dir":"Articles","previous_headings":"Customizing test scripts","what":"Adding delays","title":"Testing in depth","text":"cases, may need wait amount time steps (e.g. waiting CSS animations). can adding Sys.sleep() script. example: However, waiting Shiny reactives calculated, please read Waiting output (input) value section.","code":"Sys.sleep(0.5)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"controlling-random-values","dir":"Articles","previous_headings":"Customizing test scripts","what":"Controlling random values","title":"Testing in depth","text":"application uses randomly-generated values (calling functions like rnorm, runif, sample directly indirectly), , normal operation, produce different results run. shinytest2 works comparing current state application previous state, random changes cause test failures. make applications exactly repeatable, can set random seed. can done specifying random seed recorder. seed can integer value. test script already created, can set random seed editing test script AppDriver$new() call value seed. Moreover, need tests pass multiple versions R different RNGkind() defaults (e.g., 3.5 3.6), may want set fixed RNGkind() across tests (perhaps via RNGversion(\"3.5.0\")). However, using AppDriver$new(variant=) value contains R version can also remedy situation. many cases, instead setting random seed, elegant use output preprocessor.","code":"app <- AppDriver$new(seed = 4323)"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"tabs","dir":"Articles","previous_headings":"Widgets","what":"Tabs","title":"Testing in depth","text":"tabbed views, tabsetPanel() navbarPage(), order shinytest2 keep track tab currently selected, must id. example: ","code":"tabsetPanel(id = \"tabs\", ....) navbarPage(id = \"tabs\", ....)"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"uploading-files","dir":"Articles","previous_headings":"Widgets","what":"Uploading files","title":"Testing in depth","text":"record file upload event fileInput, test script line like : Notice filename \"mtcars.csv\" appears script without full file path. test recorder know file came ; knows name file. run test script, must copy file tests/testthat/ directory. See tests/testthat/ subdirectory app example. copying file directory, run test_app() usual.","code":"app$uploadFile(file1 = \"mtcars.csv\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"view-the-headless-browser","dir":"Articles","previous_headings":"Widgets","what":"View the headless browser","title":"Testing in depth","text":"step script, can inspect state application different ways. recommended way call app$view(). open browser window default Chrome browser. Another way take screenshot application. can call app$get_screenshot() take screenshot application. display screenshot plot. (RStudio, show Viewer pane.) Using methods, can inspect screenshot see state application.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"getting-input-output-and-export-values","dir":"Articles","previous_headings":"Widgets","what":"Getting input, output, and export values","title":"Testing in depth","text":"can also useful get current input, output, export values. fetch values without incrementing expectation counter, can call app$get_values(). returns list, can inspect str() function. may look something like : values retrieved way can used expectation-based testing. example, retrieve checkbox_out value compare known string:","code":"vals <- app$get_values()  str(vals) #> List of 3 #>  $ input :List of 4 #>   ..$ action    :Classes 'integer', 'shinyActionButtonValue'  int 0 #>   ..$ checkbox  : logi TRUE #>   ..$ check_group: chr \"1\" #>   ..$ text      : chr \"Enter text...\" #>  $ output:List of 12 #>   ..$ action_out    : chr \"[1] 0\\nattr(,\\\"class\\\")\\n[1] \\\"integer\\\"                #> \\\"shinyActionButtonValue\\\"\" #>   ..$ checkbox_out  : chr \"[1] TRUE\" #>   ..$ check_group_out: chr \"[1] \\\"1\\\"\" #>   ..$ text_out      : chr \"[1] \\\"Enter text...\\\"\" #>  $ export: Named list() vals <- app$get_values() expect_identical(vals$output$checkbox_out, \"[1] TRUE\")  # Or in a single line: expect_identical(app$get_value(output = \"checkbox_out\"), \"[1] TRUE\")"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"wait-for-value","dir":"Articles","previous_headings":"Widgets","what":"Waiting for an input (or output) value","title":"Testing in depth","text":"situations, input value set, app$set_inputs() wait 3 seconds (default) next output value sent server. , however, application immediately send value interested , need insert app$wait_for_value() function call. readily useful htmlwidgets anything involves javascript code set input values. method can also used determine input (output) values set initial output values set reactivity done two stages. example, checking checkbox adds dynamic UI, old faithful Shiny example, three round trips browser Shiny server need occur. Checking checkbox Putting slider plot placeholder app’s UI slider recognized browser, send information back Shiny causing plot rendered placed browser use app$set_inputs(\"chkbx\", TRUE) immediately take snapshot, likely miss correct plot value. dig , can look situation’s example code: app.R: Naively, add Sys.sleep() function calls slow shinytest2 testing hope Shiny application stable state. ./tests/testthat/test-use-sleep-bad.R: pattern probably fail executed slower machine. pattern sleeping hoping replaced app$wait_for_idle() app$wait_for_value(). app$wait_for_idle() wait whole application idle 500ms (default). method intuitive, generic, easier code. app$wait_for_value() wait specific input value ignoreed value. method specific requires logic code. ./tests/testthat/test-wait-good.R:","code":"library(shiny)  ui <- fluidPage(   checkboxInput(\"chkbx\", \"Display Graph?\", FALSE),   uiOutput(\"dynamic_output\") )  server <- function(input, output) {   output$dynamic_output <- renderUI({     if(!input$chkbx) {       return(NULL)     }     tagList(       sliderInput(inputId = \"bins\", label = \"Number of bins:\", min = 1, max = 50, value = 30),       plotOutput(outputId = \"dist_plot\")     )   })    # Will not execute until `input$bins` is available   # `input$bins` is not available until `chkbx` is checked   output$dist_plot <- renderPlot({     # artificially slow the plot     Sys.sleep(5)      x    <- faithful$waiting     bins <- seq(min(x), max(x), length.out = input$bins + 1)     hist(x, breaks = bins, col = \"#75AADB\", border = \"white\",          xlab = \"Waiting time to next eruption (in mins)\",          main = \"Histogram of waiting times\")   }) } shinyApp(ui = ui, server = server) test_that(\"Sleeping can work to wait for an app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs('chkbx' = TRUE)   # Hope that the plot appears within 7 seconds   Sys.sleep(7)    app$snapshot()    app$set_inputs(bins = 40)   # Hope the newer plot appears within 7 seconds   Sys.sleep(7)    app$expect_values() }) test_that(\"Use $wait_for_idle() for app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs(chkbx = TRUE)    # Wait until Shiny is not busy for 500ms   app$wait_for_idle(500)    # Make expectation   app$expect_values()    # Change slider value to 40   app$set_inputs(bins = 40, wait_ = FALSE)   # Wait until Shiny is not busy for 500ms   app$wait_for_idle(500)    # Make expectation   app$expect_values() })  test_that(\"Use $wait_for_value() for app to stabilize\", {   app <- AppDriver$new()    # Check the box to display the slider and plot   app$set_inputs(chkbx = TRUE)    # Wait until `output$dist_plot` is not `NULL`   # (Store the retrieved plot value for later comparison)   first_plot_value <- app$wait_for_value(output = \"dist_plot\", ignore = list(NULL))    # Make expectation   app$expect_values()    # Change slider value to 40   app$set_inputs(bins = 40, wait_ = FALSE)   # Wait until plot does not equal the plot with 30 bins   app$wait_for_value(output = \"dist_plot\", ignore = list(first_plot_value))    app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"dealing-with-dynamic-data","dir":"Articles","previous_headings":"","what":"Dealing with dynamic data","title":"Testing in depth","text":"application uses data source changes time, snapshot taken yesterday may match snapshot taken today, even app hasn’t changed. Dynamic data inherently poses challenge snapshot-based testing. problem can avoided detecting application tested, case use static data set instead. detection, can something like following:","code":"if (isTRUE(getOption(\"shiny.testmode\"))) {   # Load static/dummy data here } else {   # Load normal dynamic data here }"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"using-variant-to-expect-different-snapshots","dir":"Articles","previous_headings":"","what":"Using variant to expect different snapshots","title":"Testing in depth","text":"can variants deal cases snapshot output varies want capture test variations. Common use cases include variations operating system, R version, version key dependency. Variants advanced feature. use , ’ll need carefully think testing strategy ensure important variants covered automated tests, ensure way get snapshot changes CI system back repo. recommended use AppDriver$new(variant= platform_variant()) capture operating system R version test running. Variants required calling $expect_screenshot(). NULL value may used, recommended testing reproducibility. shinytest2 expectation methods eventually call testthat::expect_snapshot_file() save snapshot files. Snapshot expectations compare variant’s version snapshot file.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"inputs-without-input-bindings","dir":"Articles","previous_headings":"Limitations","what":"Inputs without input bindings","title":"Testing in depth","text":"input components Shiny set values communicating something called input binding. shinytest2 works well input values set via input bindings. However, components set input values without using input binding. include htmlwidgets, DT plotly, well Shiny’s built-plot interactions renderPlot(). set unbound inputs, resulting test script code look something like : test script replayed, headless browser set inputs specified values send server running Shiny R. However, browser able tell input object exact behaviors. example, DT, row selected, mouse click event browser triggers DataTable highlight row browser also set input value Shiny. shinytest2 plays script, can latter part, setting input value. result screenshot taken, highlighted rows. components internal state updated response user interaction, internal state updated test script played. cases, may mean script played, behavior script played user actually interacts application. input component sets multiple input values (without bindings) response single user event, may make sense coalesce single set_inputs call, :","code":"app$set_inputs(table_rows_selected = 1, allow_no_input_binding_ = TRUE) app$set_inputs(table_row_last_clicked = 1, allow_no_input_binding_ = TRUE) app$set_inputs(   table_rows_selected = 1,   table_row_last_clicked = 1,   allow_no_input_binding_ = TRUE )"},{"path":"https://rstudio.github.io/shinytest2/articles/in-depth.html","id":"next","dir":"Articles","previous_headings":"","what":"Next","title":"Testing in depth","text":"Learn using shinytest2 continuous integration.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"expectations","dir":"Articles","previous_headings":"","what":"Expectations","title":"Robust testing","text":"Unit tests provide sense security making assertions expected behavior. unit tests pass, can declare object/method valid. 🦆 Let’s look quick example :","code":"add_abs <- function(x, y) {   abs(x + y) }"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"confirm-the-expected-behavior","dir":"Articles","previous_headings":"Expectations","what":"Confirm the expected behavior","title":"Robust testing","text":"test positive numbers, can guess answer using +. However, negative number used, different behavior +. must test situations. Even better, let’s test four positive/negative situations: concept can even expanded vectors values. However, can lead lot code.","code":"x <- 50; y <- 42 testthat::expect_equal(add_abs(x, y), x + y) x <- 50; y <- -42 testthat::expect_equal(add_abs(x, y), x + y) for (info in list(   list(x =  50, y =  42, expected =  92),   list(x = -50, y =  42, expected =  8),   list(x =  50, y = -42, expected =  8),   list(x = -50, y = -42, expected =  92) )) {   testthat::expect_equal(     add_abs(info$x, info$y),     info$expected   ) }"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"assert-as-little-unnecessary-information","dir":"Articles","previous_headings":"Expectations","what":"Assert as little unnecessary information","title":"Robust testing","text":"Tests strive confirm behavior control . example, interested behavior abs, concerned behavior +. can assume + working properly adds two numbers together. necessarily need perform multitude nonsense input testing +, may make sense see abs() handles non-number input values. test also repeated swapping x y.","code":"testthat::expect_equal(add_abs(1, NA), NA) testthat::expect_equal(add_abs(1, NULL), numeric(0)) testthat::expect_error(add_abs(1, \"string\"))"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"write-clear-direct-tests","dir":"Articles","previous_headings":"Expectations","what":"Write clear, direct tests","title":"Robust testing","text":"writing tests, test can contain many expectations expectation pertain test run. example, two situations included test block: Instead, broken two separate tests, descriptive title. testthat great job displaying output user thing go wrong. first test goes wrong, error given like great error found, also difficult determine assertion failed. Adding labels expectation allows provide context test failed. Another pattern provides context allows tests move -loop around call test_that() give test custom name: isolates test even let earlier expectation stop testing later expectation.","code":"# File: tests/testthat/test-add_abs-bad.R  test_that(\"add_abs() works\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   }    expect_equal(add_abs(1, NA), NA)   expect_equal(add_abs(1, NULL), numeric(0))   expect_error(add_abs(1, \"string\")) }) # File: tests/testthat/test-add_abs-better.R  test_that(\"add_abs() adds two numbers\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x =  50, y = -42, expected =  -8),     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   } })  test_that(\"add_abs() handles non-numeric input\", {   expect_equal(add_abs(1, NA), NA)   expect_equal(add_abs(1, NULL), numeric(0))   expect_error(add_abs(1, \"string\")) }) ── Failure (Line 9): add_abs() adds two numbers ──────────────────────────────── add_abs(info$x, info$y) (`actual`) not equal to info$expected (`expected`).    `actual`:  8 `expected`: -8 # File: tests/testthat/test-add_abs-label.R  test_that(\"add_abs() adds two numbers\", {   for (info in list(     list(x =  50, y =  42, expected =  92),     list(x = -50, y =  42, expected =  8),     list(x =  50, y = -42, expected =  8),     list(x =  50, y = -42, expected =  -8), # <- Failing line     list(x = -50, y = -42, expected =  92)   )) {     expect_equal(       add_abs(info$x, info$y),       info$expected,       label = paste0(\"x:\", info$x, \"; y:\", info$y),       expected.label = info$expected     )   } }) #> ── Failure (Line 9): add_abs() adds two numbers ──────────────────────────────── #> x:50; y:-42 (`actual`) not equal to info$expected (`expected`). #> #>   `actual`:  8 #> `expected`: -8 # File: tests/testthat/test-add_abs-label.R  for (info in list(   list(x =  50, y =  42, expected =  92),   list(x = -50, y =  42, expected =  8),   list(x =  50, y = -42, expected =  8),   list(x =  50, y = -42, expected =  -8), # <- Failing line   list(x = -50, y = -42, expected =  92) )) {   test_that(paste0(\"add_abs() adds two numbers: [\", info$x, \", \", info$y, \"]\"), {     expect_equal(       add_abs(info$x, info$y),       info$expected     )   }) } #> Test passed 🎊 #> Test passed 🎉 #> Test passed 🌈 #> ── Failure (Line 9): add_abs() adds two numbers: [50, -42] ───────────────────── #> add_abs(info$x, info$y) (`actual`) not equal to info$expected (`expected`). #> #>   `actual`:  8 #> `expected`: -8 #> Test passed 🥇"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"shinytest2-expectations","dir":"Articles","previous_headings":"","what":"{shinytest2} expectations","title":"Robust testing","text":"shinytest2 handful built expectation methods: AppDriver$expect_unqiue_names(): Assert input output names unique AppDriver$expect_values(): Expect input, output, export values consistent AppDriver$expect_download(): Expect downloaded file downloadable AppDriver$expect_text(): Expect text content given selector consistent AppDriver$expect_html(): Expect HTML content given selector consistent AppDriver$expect_js(): Expect JavaScript return value consistent AppDriver$expect_screenshot(): Expect screenshot UI consistent","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"inputoutput-names","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"input/output names","title":"Robust testing","text":"method ’d like quickly gloss AppDriver$expect_unique_names(). method called (default) AppDriver$new(check_names = TRUE) confirms input output HTML names duplicated. duplicate values found, results invalid HTML possible failure within Shiny. behavior use add _out end output, e.g. outputs$text_out. use dynamic UI want reassert names still unique, perfectly acceptable call AppDriver$expect_unique_names() setting dynamic UI values.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"shiny-values","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"Shiny values:","title":"Robust testing","text":"AppDriver$expect_values() preferred method testing shinytest2. method tests different input, output, export values provided Shiny application. input corresponds input values provided Shiny application. output corresponds output values provided Shiny application. export corresponds value _export_ed Shiny application. values exported shiny::exportTestValues() within server function. AppDriver$expect_values() called, input, output, export value serialized JSON saved snapshot file (e.g. 001.json) followup expectations. addition value snapshot file, debug screenshot saved snapshot directory file name ending _.png (e.g. 001_.png). screenshot useful knowing application looked like values captured. However, differences captured screenshot never cause test failures. recommended add _.new.png .gitignore file ignore new debug screenshots accepted. typical app testing, method cover testing needs. (Remember, try test content control .)","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"downloads","dir":"Articles","previous_headings":"{shinytest2} expectations > Shiny values:","what":"Downloads","title":"Robust testing","text":"shiny::downloadButton() shiny::downloadLink() elements clicked, file downloaded. make expectation downloaded file, can use AppDriver$expect_download(). addition file saved, snapshot file name downloaded saved suggested file name used.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"ui-expectations","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"UI expectations","title":"Robust testing","text":"Two methods provided middle ground taking screenshots testing Shiny app values: AppDriver$expect_text() AppDriver$expect_html(). AppDriver$expect_text(selector=) asks Chrome browser current text contents within selected elements. method great test contents input output values. AppDriver$expect_text() able retrieve pseudo elements values text inside <text> <textarea> input elements. AppDriver$expect_html(selector=) asks Chrome browser current DOM structures within selected elements. method perfect app authors contructing DOM structures want verify consistently produced. , AppDriver$expect_html() able retrieve pseudo elements values text inside <text> <textarea> input elements. Finally, methods wrap around AppDriver$expect_js(script=). method executes script return value saved snapshot. AppDriver$expect_text() AppDriver$expect_html() wrappers around AppDriver$expect_js().","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"ui-visual-expectations","dir":"Articles","previous_headings":"{shinytest2} expectations","what":"UI visual expectations","title":"Robust testing","text":"Taking screenshot brittle expectation provided shinytest2. AppDriver$expect_screenshot() used absolutely necessary willing handle many false-positive failures. many ways screenshot expectation can fail unrelated code including: * R version changed * operating system changed (e.g. Windows vs. Linux) * system font changed * Chrome consistent paints DOM elements * CSS transitions finish time * package author (e.g. Shiny, bslib, htmltools) changed DOM structure App authors use custom CSS JavaScript may find method useful. still strongly recommended test content control avoid false-positive failures. expecting screenshot, AppDriver$new(variant=) must supplied. value may NULL, recommended use shinytest2::platform_variant().","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"exported-values","dir":"Articles","previous_headings":"Suggested approaches","what":"Exported values","title":"Robust testing","text":"can recommended enough use shiny::exportTestValues() test Shiny app’s reactive values. make assumption package authors create consistent render methods, can test values provided render methods using shiny::exportTestValues(). Let’s look example Shiny app displays plot first n rows data. recommended make render methods contain little logic value rendered can also exported. dt plot_obj exported. means available executing AppDriver$get_values(), AppDriver$get_value(), AppDriver$expect_values(). Plots notoriously hard test consistently time different platforms. Similar AppDriver$expect_screenshot(), many ways outside code plot can produce change fail visual test. include: Default system font changes. Different operating systems different fonts. Default system font size changes R version changes possible, recommended use {ggplot2} base::plot() ggplot2 getting closer closer cross platform compatible. ggplot2 objects can also inspected compared using {vdiffr} cross platform support.","code":"library(shiny) library(ggplot2) ui <- fluidPage(   numericInput(\"n\", \"Number of rows\", 10, 1, nrow(cars)),   plotOutput(\"plot\") ) server <- function(input, output) {   dt <- reactive({     head(cars, input$n)   })   plot_obj <- reactive({     ggplot(dt(), aes_string(\"speed\", \"dist\")) + geom_point()   })    output$plot <- renderPlot({     plot_obj()   })    exportTestValues(     dt = dt(),     plot_obj = plot_obj()   ) } plot_app <- shinyApp(ui = ui, server = server) plot_app app <- AppDriver$new(plot_app)  values <- app$get_values() str(values) # Output has been truncated for printing #> List of 3 #>  $ input :List of 1 #>   ..$ n: int 10 #>  $ output:List of 1 #>   ..$ plot:List of 5 #>   .. ..$ src     : chr \"data:image/png;base64,iVBORw0\"| __truncated__ #>   .. ..$ width   : int 962 #>   .. ..$ height  : int 400 #>   .. ..$ alt     : chr \"Plot object\" #>   .. ..$ coordmap:List of 2 | __truncated__ #>  $ export:List of 2 #>   ..$ dt      :'data.frame': 10 obs. of  2 variables: #>   .. ..$ speed: num [1:10] 4 4 7 7 8 9 10 10 10 11 #>   .. ..$ dist : num [1:10] 2 10 4 22 16 10 18 26 34 17 #>   ..$ plot_obj:List of 9 #>   .. ..$ data       :'data.frame':   10 obs. of  2 variables: #>   .. .. ..$ speed: num [1:10] 4 4 7 7 8 9 10 10 10 11 #>   .. .. ..$ dist : num [1:10] 2 10 4 22 16 10 18 26 34 17 #>   .. ..$ layers     :List of 1 | __truncated__ #>   .. ..$ scales     :Classes 'ScalesList', 'ggproto', 'gg' <ggproto object: Class | __truncated__ #>   .. ..$ mapping    :List of 2 | __truncated__ #>   .. ..$ theme      : list() | __truncated__ #>   .. ..$ coordinates:Classes 'CoordCartesian', 'Coord', 'ggproto', 'gg' <ggproto  | __truncated__ #>   .. ..$ facet      :Classes 'FacetNull', 'Facet', 'ggproto', 'gg' <ggproto object: Class  | __truncated__ #>   .. ..$ plot_env   :<environment: 0x7fad13bd3d58> #>   .. ..$ labels     :List of 2 #>   .. .. ..$ x: chr \"speed\" #>   .. .. ..$ y: chr \"dist\" #>   .. ..- attr(*, \"class\")= chr [1:2] \"gg\" \"ggplot\""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"snapshots-vs-values","dir":"Articles","previous_headings":"Suggested approaches","what":"Snapshots vs values","title":"Robust testing","text":"Snapshot testing makes test writing minimal quick. However, comes logical risk. Snapshots wonderful determining change occurred. first execution snapshot nothing compare, first value taken truth even correct. allows opportunity invalid values saved truth. time, OK use snapshots beginning testing experience, keeping track snapshot file can tedious testing multiple applications multiple variants. remedy possibility, app values can tested known static values. example, instead testing initial value dt() snapshot, can test head(cars, 10). time manually inspect snapshot files afterwards, using AppDriver snapshot code provides clean, minimal code. snapshot files unwieldy, can use AppDriver retrieve values test known values.","code":"# Snapshot code app$expect_values(export = \"dt\")  # Manual expectation code expect_equal(   app$get_value(export = \"dt\"),   head(cars, 10) )"},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"example","dir":"Articles","previous_headings":"Suggested approaches","what":"Example","title":"Robust testing","text":"Let’s look write shinytest2 test make sure plot updated updating numeric input n. Assuming Shiny app code saved app.R, can look tests/testthat/test-export.R . Since calling AppDriver$expect_screenshot() AppDriver$get_screenshot(), need use AppDriver$new(variant=). second half test performs similar expectations first half test. code can pulled helper function written : noted ggplot2 objects can serialized JSON excluded AppDriver$expect_values() snapshots.","code":"# File: ./tests/testthat/test-export.R # App file: ./app.R library(shinytest2)  test_that(\"`export`ed `plot_obj` is updated by `n`\", {    app <- AppDriver$new()    # Verify `dt()` uses first 10 lines of `cars`   n10 <- app$get_value(input = \"n\")   expect_equal(n10, 10)   # Verify `dt10()` data is first 10 lines of `cars`   dt10 <- app$get_value(export = \"dt\")   expect_equal(dt10, head(cars, n10))    # Verify `plot_obj()` data is `dt()`   plot_obj_10 <- app$get_value(export = \"plot_obj\")   expect_equal(plot_obj_10$data, dt10)   # Verify `plot_obj()` is consistent   vdiffr::expect_doppelganger(\"cars-points-10\", plot_obj_10)    ## Update `n` to 20   app$set_inputs(n = 20)    # Verify `n` was updated   n20 <- app$get_value(input = \"n\")   expect_equal(n20, 20)   # Verify `dt()` uses first 20 lines of `cars`   dt20 <- app$get_value(export = \"dt\")   expect_equal(dt20, head(cars, n20))    # Verify `plot_obj()` data is `dt()`   plot_obj_20 <- app$get_value(export = \"plot_obj\")   expect_equal(plot_obj_20$data, dt20)   vdiffr::expect_doppelganger(\"cars-points-20\", plot_obj_20) }) # File: tests/testthat/test-export.R library(shinytest2)  test_that(\"`export`ed `plot_obj` is updated by `n`\", {    app <- AppDriver$new(variant = platform_variant())    expect_n_and_plot <- function(n) {     # Verify `n` input equals `n`     n_val <- app$get_value(input = \"n\")     expect_equal(n_val, n, expected.label = n)     # Verify `dt()` data is first `n` lines of `cars`     dt <- app$get_value(export = \"dt\")     expect_equal(dt, head(cars, n), expected.label = paste0(\"head(cars, \", n, \")\"))      # Verify `plot_obj()` data is `dt()`     plot_obj <- app$get_value(export = \"plot_obj\")     expect_equal(plot_obj$data, dt, info = paste0(\"n = \", n))     # Verify `plot_obj()` is consistent     vdiffr::expect_doppelganger(paste0(\"cars-points-\", n), plot_obj)   }    expect_n_and_plot(10)    # Update `n` to 20   app$set_inputs(n = 20)   expect_n_and_plot(20) })"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"retrieving-values","dir":"Articles","previous_headings":"Cliff Notes","what":"Retrieving values","title":"Robust testing","text":"Best way retrieve values serialized saveRDS() Safest way compare values comparisons (e.g. expect_equal()) need explicitly stated beginning Pro: Supports complex objects like ggplot2 plots Con: Causes code verbose","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/robust.html","id":"expectation-methods","dir":"Articles","previous_headings":"Cliff Notes","what":"Expectation methods","title":"Robust testing","text":"AppDriver$expect_*() snapshots manually inspected first created ensure contain expected content. Go-expectation method Shiny input, output, export values Automatically recorded shinytest2::record_app() Saves debug screenshot manual inspection Pro: Tests (almost) Shiny values Con: Complex objects containing environments (e.g. ggplot2 plots) can serialized JSON Get: AppDriver$get_value() AppDriver$get_values() Automatically recorded shinytest2::record_app() Pro: save snapshot requested filename Get: AppDriver$get_download() Safest way retrieve text given selector stable AppDriver$expect_html(). Gives freedom UI authors make HTML structure changes Pro: Can test non-Shiny content using selector Con: Can used test text inputs Get: AppDriver$get_text() Expects HTML consistently shaped given selector stable AppDriver$expect_screenshot(). Gives freedom UI authors. Pro: Can test non-Shiny content using selector Con: Can used test text inputs Get: AppDriver$get_html() Makes expectation JavaScript result Building block AppDriver$expect_text() AppDriver$expect_html() Con: Must write JavaScript code test. Get: AppDriver$get_js() Saves screenshot selector (defaults \"html\") later comparison Strongly recommended use testing methods possible Pro: picture can worth thousand [tests] Con: Screenshot reproducibility brittle non-Shiny changes Get: AppDriver$get_screenshot()","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"why-test-shiny-applications","dir":"Articles","previous_headings":"","what":"Why test Shiny applications?","title":"Getting started with shinytest2","text":"get Shiny application state works, ’s often useful automated system checks continues work expected. many possible reasons application stop working. reasons include: upgraded R package different behavior. (include Shiny !) make modifications application. external data source stops working, returns data changed format. One way detect problems manual testing – words, person interact app browser – can time-intensive, inconsistent, imprecise. automated tests can alert kinds problems quickly almost zero effort, tests created.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"how-testing-works-with-shinytest2","dir":"Articles","previous_headings":"","what":"How testing works with shinytest2","title":"Getting started with shinytest2","text":"shinytest2 package provides tools creating running automated tests Shiny applications. shinytest2 uses testthat’s snapshot-based testing strategy. first time runs set tests application, performs scripted interactions app takes one snapshots application’s state. snapshots saved disk future runs tests can compare results . create tests, easiest method use record_test() function. launches application web browser records interactions application. interactions saved tests/testthat/test-shinytest2.R run using strategy described .","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"Getting started with shinytest2","text":"Begin installing shinytest2 CRAN:","code":"install.packages(\"shinytest2\")"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"recording-tests","dir":"Articles","previous_headings":"Getting started","what":"Recording tests","title":"Getting started with shinytest2","text":"general procedure recording tests: Run record_test() launch app test recorder. Create tests interacting application telling recorder make expectation state various points. Quit test recorder. , three things happen: test script saved tests/testthat/test-shinytest2.R subdirectory application. running RStudio IDE, automatically open file editor. tests execute record tests, first need app. simple app ’ve placed simple-app/app.R: test , now load {shinytest2}, call record_test() path app: separate R process, launches Shiny application tested. ’ll refer target app. also launches special Shiny application current R process displays target app iframe controls outside iframe. ’ll refer recorder app. see something like : left target app (case, “name” app), right recorder app sidebar. Note may need make browser window wider recorder sidebar occupies space. sidebar right displays controls test recorder, well set Code expectations actions. interact target app – words, set inputs app – see actions recorded Code output. testing Shiny application, setting inputs one part. ’s also necessary check application produces correct outputs. accomplished taking expectations application’s state. two ways record output values. One way take expectation application’s state. record input values, output values, exported values (exported values later). , click Expect values button recorder app. modifying inputs making expectation, look something like : also possible take targeted value expectation. snapshot one specified output (instead default, snapshot entire application). , hold Control (Command) button keyboard click output; snapshot just one output. done recording sequence events, click Save test exit button. RStudio IDE, open test script tests/testthat/test-shinytest2.R subdirectory application.","code":"library(shiny) ui <- fluidPage(   textInput(\"name\", \"What is your name?\"),   actionButton(\"greet\", \"Greet\"),   textOutput(\"greeting\") ) server <- function(input, output, session) {   output$greeting <- renderText({     req(input$greet)     paste0(\"Hello \", isolate(input$name), \"!\")   }) } shinyApp(ui, server) library(shinytest2) record_test(\"simple-app/\") # File: tests/testthat/test-shinytest2.R library(shinytest2)  test_that(\"{shinytest2} recording: simple-app\", {   app <- AppDriver$new(name = \"simple-app\", height = 407, width = 348)   app$set_inputs(name = \"Barret\")   app$click(\"greet\")   app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"running-tests","dir":"Articles","previous_headings":"Getting started","what":"Running tests","title":"Getting started with shinytest2","text":"quit test recorder, automatically run test script. three separate components involved running tests: First test driver. R process coordinates testing controls web browser. working creating tests interactively, R process use. Next Shiny process, also known server. R process runs target Shiny application. Finally, web browser, also known client, connects server. headless web browser – one renders web page internally, doesn’t display content screen ({chromote}). exit test recorder, (default) automatically run test script print something like : Behind scenes, runs test_app(). can manually run tests : play back interactions record snapshots, specified test script. first time tests run, saved subdirectory app called tests/testthat/_snaps. expected results, future test runs compared . directory contain two types files different expectations. example: .json file JSON representation state application app$expect_values() called. .png file screenshot application app$expect_screenshot(), can use insure visual state application change. _.png file debug screenshot application app$expect_values() called. file tracked using git know application visually changes time. However, difference found new screenshot, difference throw error. JSON file stores state input, output, export values time snapshot: using source control system (like git), check expected results. (ignore _.new.png files.)","code":"• Saving test runner: tests/testthat.R • Saving test file: tests/testthat/test-shinytest2.R • Running recorded test: tests/testthat/test-shinytest2.R ✔ | F W S  OK | Context ✔ |   2     1 | shinytest2 [2.6s] ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001_.png'  Warning (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Adding new file snapshot: 'tests/testhat/_snaps/simple-app-001.json' ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────  ══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ Duration: 2.6 s  [ FAIL 0 | WARN 2 | SKIP 0 | PASS 1 ] test_app(\"simple-app\", filter = \"shinytest2\") 001.json 001_.png 002.png {   \"input\": {     \"greet\": 1,     \"name\": \"Barret\"   },   \"output\": {     \"greeting\": \"Hello Barret!\"   },   \"export\": {    } }"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"subsequent-test-runs","dir":"Articles","previous_headings":"Getting started","what":"Subsequent test runs","title":"Getting started with shinytest2","text":"initial test run, can run tests future check changes application’s behavior. changes snapshots, just see something like , additional output: results exactly , test considered successful. differences latest run expected results, ’ll see output like : view differences, follow prompted code testthat::snapshot_review('shinytest2/') within application directory. look something like : inspecting changes, can choose update expected results (, replace old expected results new current results), just quit without updating. update results changes expected. skip/quit without updating changes unexpected.","code":"> test_app(\"path/to/app\") ✔ | F W S  OK | Context ✔ |         1 | shinytest2 [2.2s]  ══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ Duration: 2.2 s  [ FAIL 0 | WARN 0 | SKIP 0 | PASS 1 ] ✔ | F W S  OK | Context ✖ | 1       0 | shinytest2 [2.1s] ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Failure (test-shinytest2.R:7:3): {shinytest2} recording: simple-app Snapshot of `file` to 'shinytest2/simple-app-001.json' has changed Run `testthat::snapshot_review('shinytest2/')` to review changes Backtrace: 1. app$expect_values()       at test-shinytest2.R:7:2 2. shinytest2::app_expect_values(...)       at shinytest2.nosync/R/app-driver.R:651:6 3. shinytest2::app__expect_snapshot_file(...)       at shinytest2.nosync/R/app-driver-expect-values.R:211:2 4. testthat::expect_snapshot_file(...)       at shinytest2.nosync/R/expect-snapshot.R:35:2 ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────  ══ Results ══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ Duration: 2.2 s  [ FAIL 1 | WARN 0 | SKIP 0 | PASS 0 ]"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"multiple-test-scripts","dir":"Articles","previous_headings":"Getting started","what":"Multiple test scripts","title":"Getting started with shinytest2","text":"example , single test script, named test-shinytest2.R. want one set tests application, can record new tests, unique name. can enter name recording tests: saved test can moved different testing file, e.g. tests/testthat/test-simple-app.R. run test_app(\"path//app\"), run tests scripts application’s tests/testhat directory.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"interactive-r-markdown-documents","dir":"Articles","previous_headings":"","what":"Interactive R Markdown documents","title":"Getting started with shinytest2","text":"shinytest2 can used interactive R Markdown documents use runtime: shiny server: shiny (sometimes also referred Shiny documents). includes use flexdashboard package. Shiny documents differences compared regular Shiny applications, tests slightly different. example interactive Rmd tests, please follow link.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"randomness","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"Randomness","title":"Getting started with shinytest2","text":"Shiny Rmd application, UI application created dynamically, using randomly generated IDs. make results repeatable, must set random seed; otherwise output slight differences run. See section controlling random values information.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"one--rmd-file-per-directory","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"One .Rmd file per directory","title":"Getting started with shinytest2","text":"testing Shiny documents, one .Rmd file allowed per directory. way test directory structured. (Note name Shiny document index.Rmd, deployed Shiny Server, URL can use directory name, like http://mydomain.com/dirname/, instead http://mydomain.com/dirname/index.Rmd. deployed RStudio Connect Shinyapps.io, filename automatically used URL.)","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"prerendered-shiny-documents","dir":"Articles","previous_headings":"Interactive R Markdown documents","what":"Prerendered Shiny documents","title":"Getting started with shinytest2","text":"Shiny documents use runtime: shiny_prerendered, helps speed page loading time. Normally, first time applications run, leave behind generated .html file well cache directory named myfile_data/. can remove files adding end test script (assuming name document doc.Rmd): Alternatively, can save generated files, tests run generated files, prerendering step run future tests. example prerendered .Rmd tests, please follow link.","code":"rmarkdown::shiny_prerendered_clean(\"../doc.Rmd\")"},{"path":"https://rstudio.github.io/shinytest2/articles/shinytest2.html","id":"next","dir":"Articles","previous_headings":"","what":"Next","title":"Getting started with shinytest2","text":"Learn shinytest testing depth article.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Using shinytest2 with continuous integration","text":"overall procedure enabling tests CI platform : First create tests locally (development machine) save expected results. Commit expected results project’s git repository push GitHub. Create GitHub Actions workflow file run tests GitHub Actions (GHA). set continuous integration, typical development cycle : Modify project, commit, push changes. CI platform automatically action, downloads code runs tests. tests fail, send email alert. develop application, may also appropriate add, remove, modify tests, re-run tests save new expected results.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"a-repository-with-a-single-application","dir":"Articles","previous_headings":"","what":"A repository with a single application","title":"Using shinytest2 with continuous integration","text":"Shiny applications aren’t part R package, two common ways repository set : repository contains one application, application files (like app.R global.R) contained top level repository. repository contains one application files, application contained subdirectory. section explains set GHA test repository single application. directory structure project look something like : files need add described .","code":"/ ├── .github │   └── workflows │       └── check-app.yaml ├── .Rprofile ├── README.md ├── app.R ├── renv/activate.R ├── renv.lock └── tests     ├── testthat.R     └── testthat         ├── _snaps         │   └── shinytest2         │       ├── 001.json         │       ├── 002.png         │       ├── 003.json         │       └── 004.png         └── test-shinytest2.R"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"check-app-yaml","dir":"Articles","previous_headings":"A repository with a single application","what":"check-app.yaml","title":"Using shinytest2 with continuous integration","text":"file contains information GitHub Actions build test application. look similar : change os r version (set ubuntu-20.04 4.1 ) whatever operating system R version used platform application deployed .","code":"# Workflow derived from https://github.com/r-lib/actions/blob/v2-branch/examples/check-standard.yaml # Need help debugging build failures? Start at https://github.com/r-lib/actions#where-to-find-help on:   push:     branches: [main, master]   pull_request:     branches: [main, master]  name: test-app  jobs:   test-app:     runs-on: ${{ matrix.config.os }}      name: ${{ matrix.config.os }} (${{ matrix.config.r }})      strategy:       fail-fast: false       matrix:         config:           - {os: ubuntu-20.04, r: '4.1'}      env:       GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}       R_KEEP_PKG_SOURCE: yes      steps:       - uses: actions/checkout@v2        - uses: r-lib/actions/setup-pandoc@v2        - uses: r-lib/actions/setup-r@v2         with:           r-version: ${{ matrix.config.r }}           http-user-agent: ${{ matrix.config.http-user-agent }}           use-public-rspm: true        - uses: r-lib/actions/setup-renv@v2        - uses: rstudio/shinytest2/actions/test_app@v1         with:           path: \".\""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"renv-lock-renvactivate-r--rprofile","dir":"Articles","previous_headings":"A repository with a single application","what":"renv.lock, renv/activate.R, .Rprofile","title":"Using shinytest2 with continuous integration","text":"renv project-local dependency management system projects. useful Shiny applications using specific package versions Shiny app dependencies. renv uses mechanism used shinyapps.io RStudio Connect. renv auto-generates three files using isrenv::init() renv::snapshot(). create .Rprofile renv/activate.R, call renv::init() within App project. create / update renv.lock, call renv::snapshot(). Whenever update packages development machine, run renv::snapshot() command make sure packages used GitHub stay sync. learn renv, please see Introduction renv Colaborating renv articles. alternative using renv create DESCRIPTION file. lock package versions; instead, use latest version package CRAN.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"running-the-first-build","dir":"Articles","previous_headings":"A repository with a single application","what":"Running the first build","title":"Using shinytest2 with continuous integration","text":"’ve added files, commit push GitHub. trigger build GitHub Actions (GHA). first successful run workflow GHA generally take much longer subsequent runs, needs install R packages first time. successful run, packages cached, builds much faster.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"a-repository-with-multiple-applications","dir":"Articles","previous_headings":"","what":"A repository with multiple applications","title":"Using shinytest2 with continuous integration","text":"Another way run tests using repository multiple applications, subdirectory. directory structure look something like : repository structure, configuration largely repository single app, described . difference check-app.yaml file.","code":"/ ├── .github │   └── workflows │       └── check-app.yaml ├── .Rprofile ├── README.md ├── renv/activate.R ├── renv.lock ├── 01_hello │   ├── app.R │   └── tests │       ├── testthat.R │       └── testthat │           ├── _snaps │           │   └── shinytest2 │           │       ├── 001.json │           │       ├── 002.png │           │       ├── 003.json │           │       └── 004.png │           └── test-shinytest2.R └── 06_tabsets     ├── app.R     └── tests         ├── testthat.R         └── testthat             ├── _snaps             │   └── shinytest2             │       ├── 001.json             │       ├── 002.png             │       ├── 003.json             │       ├── 004.png             │       ├── 005.json             │       └── 006.png             └── test-shinytest2.R"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"check-app-yaml-1","dir":"Articles","previous_headings":"A repository with multiple applications","what":"check-app.yaml","title":"Using shinytest2 with continuous integration","text":"check-app.yaml step application respective directory, instead testing just one application current directory.","code":"- uses: rstudio/shinytest2/check_app@v2         with:           path: \"01_hello\"       - uses: rstudio/shinytest2/check_app@v2         with:           path: \"06_tabsets\""},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"testing-applications-in-a-package","dir":"Articles","previous_headings":"","what":"Testing applications in a package","title":"Using shinytest2 with continuous integration","text":"See Using shinytest2 R packages article.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"how-do-i-add-a-status-badge-to-my-project","dir":"Articles","previous_headings":"Frequently asked questions","what":"How do I add a status badge to my project?","title":"Using shinytest2 with continuous integration","text":"See GitHub’s docs adding badge. workflow file named check-app.yaml schloerke/example-app repo, can add status badge GitHub README.md following line: README.md file, can add build status badge, like one , can see status code glance:","code":"![check-app](https://github.com/schloerke/example-app/actions/workflows/check-app.yml/badge.svg)"},{"path":"https://rstudio.github.io/shinytest2/articles/use-ci.html","id":"how-do-i-use-a-description-file-instead-of-renv","dir":"Articles","previous_headings":"Frequently asked questions","what":"How do I use a DESCRIPTION file instead of {renv}?","title":"Using shinytest2 with continuous integration","text":"Instead using renv, can use DESCRIPTION file can used tell GHA packages needed test application. Instead locking package specific version like renv, result latest version package downloaded CRAN. may appropriate want make sure application works latest version package, instead frozen set packages. use DESCRIPTION file, need modify check-app.yaml file use r-lib/actions default package installation system instead renv. Replace line template provided : want generate renv.lock, .Rprofile, renv files, run renv commands listed . Next, create DESCRIPTION file looks something like : Imports field must list R packages application directly uses. Normally latest versions listed packages installed CRAN. However, need install development versions packages GitHub, can done adding Remotes section. example: tells GitHub install shiny package main branch https://github.com/rstudio/shiny, shinytest2 package dev branch https://github.com/rstudio/shinytest2. addition branch names like dev, can use commit hashes tags.","code":"- uses: r-lib/actions/setup-renv@v2 - uses: r-lib/actions/setup-r-dependencies@v2 Imports:   shiny,   shinytest2 Remotes:   rstudio/shiny,   rstudio/shinytest2@dev"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"applications-in-inst","dir":"Articles","previous_headings":"","what":"Applications in inst/","title":"Using shinytest2 with R packages","text":"application live subdirectory inst/, shown : case, can run record_test() test_app() normal. create run tests, tests/ subdirectory application directory stores test scripts results. Since using testthat automated tests, create test driver script tests/testthat/. example, ’s named test-inst-apps.R contains following: application directory meant public, can also located ./tests/testthat/apps. shinytest2 many application appdir point relative path application.","code":"/ ├── DESCRIPTION ├── NAMESPACE ├── R ├── inst │   └── sample_app │       ├── app.R │       └── tests │           ├── testthat │           │   ├── _snaps │           │   │   └── shinytest2 │           │   │       └── 001.json │           │   └── test-shinytest2.R │           └── testthat.R └── tests     ├── testthat     │   └── test-inst-apps.R     └── testthat.R # File: tests/testthat/test-inst-apps.R library(shinytest2)  test_that(\"sample_app works\", {   # Don't run these tests on the CRAN build servers   skip_on_cran()    appdir <- system.file(package = \"exPackage\", \"sample_app\")   test_app(appdir) })"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"application-objects-created-by-functions","dir":"Articles","previous_headings":"","what":"Application objects created by functions","title":"Using shinytest2 with R packages","text":"second way application R package function returns Shiny application object. example, ’s function hello_world_app(), lives R/hello-world.R: function simply returns object shinyApp(): object, can supplied directly AppDriver$new(). help create tests, can call record_test() shiny application object directly. Unfortunately, test file able saved. Instead, test commands can copied test script manually.","code":"/ ├── .Rbuildignore ├── DESCRIPTION ├── NAMESPACE ├── R │   └── hello-world.R └── tests     ├── testthat     │   ├── _snaps     │   │   └── app-function     │   │       └── 001.json     │   └── test-app-function.R     └── testthat.R # File: R/hello-world.R  hello_world_app <- function() {   utils::data(cars)   shinyApp(     ui = fluidPage(       sliderInput(\"n\", \"n\", 1, nrow(cars), 10),       plotOutput(\"plot\")     ),     server = function(input, output) {       output$plot <- renderPlot({         plot(head(cars, input$n), xlim = range(cars[[1]]), ylim = range(cars[[2]]))       })     }   ) } # File: tests/testthat/test-app-function.R  test_that(\"hello-world app initial values are consistent\", {   # Don't run these tests on the CRAN build servers   skip_on_cran()    shiny_app <- hello_world_app()   app <- AppDriver$new(shiny_app, name = \"hello\")   app$expect_values() })"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"other-setup-steps","dir":"Articles","previous_headings":"","what":"Other setup steps","title":"Using shinytest2 with R packages","text":"steps needed types tests. recommended call shinytest2::use_shinytest() enable different test config set-ups. need add shinytest2 Suggests section DESCRIPTION file. items place, can test package using devtools::install(); testthat::test_local() running R CMD check package. using RStudio IDE, can also run Build -> Test Package Build -> Check Package. shinytest2 requires package installed testing. testthat::test_local() (related wrappers) eventually call pkgload::load_all() temporarily source local R package. can use test_local() test non-shinytest2 tests, need install R package safely execute shinytest2 tests. installed, create confusing situation shinytest2 tests running different version R package (whichever last installed), rest tests (current source).","code":"Suggests:     shinytest2"},{"path":"https://rstudio.github.io/shinytest2/articles/use-package.html","id":"continuous-integration","dir":"Articles","previous_headings":"","what":"Continuous integration","title":"Using shinytest2 with R packages","text":"like package tested every commit, can set GitHub Actions. Please see Using shinytest2 continuous integration inspiration.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"monkey-headless-testing-with-shinytest2","dir":"Articles","previous_headings":"","what":"Monkey (headless) testing with {shinytest2}","title":"Monkey testing","text":"people use shinytest2 plug play record_test() app, convenient familiar JavaScript. hood, record_test() generates R script composed series directed instructions manipulates app automate testing CI/CD environments. Monkey testing widely used web developers check application robustness, particularly apps large number inputs. goal ultimately try break app triggering unexpected combinations. available libraries JS-based gremlins.js, traditionally combined JS-based global testing libraries like Puppeteer, can work shinytest2 well. vignette, ’ll provide thorough overview AppDriver R6 class (extending depth testing), allows developer programmatically control app. ’ll see can seemlessly benefit gremlins.js lines code.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"initialize-the-driver","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2}","what":"Initialize the driver","title":"Monkey testing","text":"consider simple app composed slider plot output: driver may initialized : Note shiny_args slot allowing pass custom options shiny::runApp() port, might useful organization restricts port number. load_timeout defaults 10s 20s locally CI/CD, respectively. Therefore, app takes longer launch, can change value. Keep mind app taking 20s launch generally -optimized require specific care profiling refactoring. AppDriver starts Chrome-based headless browser. Interestingly, need specific flags available default shinytest2, can pass instantiating driver: flags considered default, particularly ---sandbox apply CI/CD (Chrome won’t start without) don’t need worry much . run script locally, may add view = TRUE open Chrome Devtools, significantly ease testing calibration. highly recommend create test protocol locally move CI/CD later bugs fixed. figure, application shown left side panel. top-right side panel shows DOM elements (default) bottom-right side panel displays JavaScript console output.","code":"ui <- fluidPage(   sliderInput(\"obs\", \"Number of observations:\",     min = 0, max = 1000, value = 500   ),   plotOutput(\"distPlot\") )  # Server logic server <- function(input, output) {   output$distPlot <- renderPlot({     hist(rnorm(input$obs))   }) }  # Complete app with UI and server components shinyApp(ui, server) headless_app <- AppDriver$new(   app_dir = \"<PATH_TO_APP>\",   name = \"monkey-test\",   shiny_args = list(port = 3515) ) chromote::set_chrome_args(   c(     chromote::default_chrome_args(),     # Custom flags: see https://peter.sh/experiments/chromium-command-line-switches/   ) )"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"injecting-gremlins-js","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2}","what":"Injecting gremlins.js","title":"Monkey testing","text":"next steps consists injecting gremlins.js dependency DOM can unleash horde.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"easy-way","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Injecting gremlins.js","what":"Easy way","title":"Monkey testing","text":"easiest way call: creates <script> tag pointing right CDN (content delivery network: optimized server store libraries) inserts end body. test whether everything worked well, can dump DOM, look scripts. able find gremlins.js try call typeof window.gremlins, return object: undefined returned instead, means something went wrong. generally JS code blocked network. case, let’s see can next part.","code":"headless_app$run_js(\"   let s = document.createElement('script');   s.src = 'https://unpkg.com/gremlins.js';   document.body.appendChild(s); \") headless_app$get_html(\"script\", outer_html = TRUE) headless_app$get_js(\"typeof window.gremlins\")"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"local-way","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Injecting gremlins.js","what":"Local way","title":"Monkey testing","text":"work corporate environment chances ’ll end situation. solution store serve local copy gremlin.js script shiny::addResourcePath(). Assuming gremlins.js inst/js/gremlins.min.js. Add app.R file: can subsequently inject gremlins DOM checks whether everything worked expected:","code":"shiny::addResourcePath(\"gremlins\", \"inst/js/gremlins.min.js\") headless_app$run_js(\"   let s = document.createElement('script');   s.src = './gremlins/gremlins.min.js';   document.body.appendChild(s); \") headless_app$get_html(\"script\", outer_html = TRUE) headless_app$get_js(\"typeof window.gremlins\")"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"a-bit-about-gremlins-js","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde","what":"A bit about gremlins.js","title":"Monkey testing","text":"workflow rather simple: create horde gremlins.createHorde(). run monkey test horde.unleash();. createHorde() accepts many species gremlins capable handling various events clicks, touch, form filling, scrolling, typing, … described gremlins.js documentation. side note, don’t recommend using scroller sometimes crashes Chrome instance. plots rely random elements like rnorm, best practice setup seed. default, species attack random order delay 10 ms event. can also control attack strategy fine tune global behavior. Finally, want control gremlins species , can define custom species.","code":"const horde = gremlins.createHorde(); horde.unleash();"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"blind-run","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde > Practice","what":"Blind run","title":"Monkey testing","text":"following, run basic Monkey test configuration: Result shown gif .","code":"headless_app$run_js(\"gremlins.createHorde().unleash();\")"},{"path":"https://rstudio.github.io/shinytest2/articles/using-monkey-testing.html","id":"optimized-testing","dir":"Articles","previous_headings":"Monkey (headless) testing with {shinytest2} > Unleash the horde > Practice","what":"Optimized testing","title":"Monkey testing","text":"really makes sense invoke species given slider? Absolutely ! following code, want test slider input.  best species perform task toucher, able randomly move slider input. documentation specifies many events tap, doubletap, gesture multitouch. seems relevant apply gesture, consisting dragging slider x-axis (note: gesture also consider y-axis make sense slider, gremlins.js limitation. however won’t prevent test running). Also, target slider handle class irs-handle single ensure don’t touch element increase number maximum touch 2 200. Note precious HTML inspector, allows seamlessly inspect extract class id. log parameter enables logging JavaScript console: can create custom horde disable FPS Alert mogwais gremlins since relevant case study: unleash promise, can execute function right , check whether script ran expected. running CI/CD can’t see Chrome Devtools, can still display logs. console.log output captured shinytest2 logs headless_app$get_logs() allowing debug refine monkey testing script.  Monkey testing lasts 10s, often want take screenshot ongoing attack:  run multiple attacks, always good practice reset Shiny inputs even close current headless app restart new session: run CI/CD, don’t forget clean session tests completed, particularly set shiny.port option (can’t 2 apps running port):","code":"const customToucher = gremlins.species.toucher({   // which touch event types will be triggered   touchTypes: ['gesture'],   // Touch only if element has class irs-handle single   canTouch: (element) => element.className === 'irs-handle single',   log: true,   maxTouches: 200 }); const horde = gremlins.createHorde({   species: [customToucher],   mogwais: [gremlins.mogwais.gizmo()] }); horde   .unleash()   .then(() => {     console.log('Gremlins test success') }); headless_app$run_js(\"   const customToucher = gremlins.species.toucher({     // which touch event types will be triggered     touchTypes: ['gesture'],     // Touch only if element has class irs-handle single     canTouch: (element) => element.className === 'irs-handle single',     log: true,     maxTouches: 200   });    gremlins.createHorde({     //randomizer: new gremlins.Chance(1234), // repeatable     species: [customToucher],     mogwais: [gremlins.mogwais.gizmo()]   }).unleash().then(() => {     console.log('Gremlins test success')   }); \")  Sys.sleep(3) headless_app$get_screenshot(\"gremlins.png\") headless_app$set_inputs(obs = 500) headless_app$stop()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"code-structure","dir":"Articles","previous_headings":"","what":"Code structure","title":"Migrating from shinytest","text":"sub sections , ShinyDriver reference shinytest::ShinyDriver R6 object. code block, ShinyDriver object referred old. Similarly, AppDriver reference shinytest2::AppDriver R6 object. shinytest2::AppDriver replaced shinytest’s ShinyDriver object referred new code block.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverclick","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$click()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$click(name, iotype = c(\"auto\", \"input\", \"output\")) parameters separated clearer intended use AppDriver$click(input, output, ..., selector).","code":"## {shinytest} old$click(\"mybutton\") old$click(\"clickcount\", iotype = \"output\") old$click(\"my_id\", iotype = \"auto\")  ## {shinytest2} new$click(\"mybutton\"); new$click(input = \"mybutton\") new$click(output = \"clickcount\") new$click(selector = \"#my_id\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexecutescript","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$executeScript()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$executeScript(script, ...) ... must now inserted script. can commands like glue::glue() paste(). Extra parameters include file can contain script content timeout throw error timeout (milliseconds) reached script returns. promise last value script resolved value sent back R session.","code":"## {shinytest} life <- 42 old$executeScript(\"1 + 1;\") old$executeScript(\"var life = arguments[0]; life;\", life)  ## {shinytest2} life <- 42 new$get_js(\"1 + 1;\") new$get_js(paste0(\"let life = \", jsonlite::toJSON(life, auto_unbox = TRUE), \"; life;\")) # If a promise is returned, the resolved value will be sent back to the R session new$get_js(   paset0(\"   let life = \", jsonlite::toJSON(life, auto_unbox = TRUE), \";   new Promise((resolve, reject) => resolve(life));   \") )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexecutescriptasync","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$executeScriptAsync()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$executeScriptAsync(script, ...) ShinyDriver$executeScriptAsync() magically made callback argument available JavaScript code block R session callback called within script. shinytest2, script need updated use JavaScript Promise. Promise’s resolve method callback used previously. also provide maximum timeout (milliseconds) willing wait error thrown. Ex:","code":"## {shinytest} # Wait until a button is clicked old$executeScriptAsync(   '   var selector = arguments[0];   var callback = arguments[1];   $( selector ).one( \"click\", function() {     callback();   });   ',   \"#mybutton\" )  ## {shinytest2} # Wait until a button is clicked new$get_js(   paste0(\"   let selector = \", jsonlite::toJSON(\"#mybutton\", auto_unbox = TRUE), \";   new Promise((resolve, reject) => {     $( selector ).one( \\\"click\\\", function() {       resolve();     });   });   \"),   timeout = 15 * 1000 )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetallvalues","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getAllValues()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE) method renamed AppDriver$get_values(..., input, output, export, hash_images = TRUE). new method slightly different behavior input, output export arguments provided. input, output export provided, method return values provided input, output export names . input, output export provided, method return values, similar setting ShinyDriver$getAllValues(input = TRUE, output = TRUE, export = TRUE).","code":"## {shinytest} old$getAllValues() # All input values old$getAllValues(input = TRUE, output = FALSE, export = FALSE) # Only `clickcount` output value old$getAllValues(input = FALSE, output = \"clickcount\", export = FALSE)  ## {shinytest2} new$get_values() # All input values new$get_values(input = TRUE) # Only `clickcount` output value new$get_values(output = \"clickcount\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetvalue","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getValue()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getValue(name, iotype = c(\"auto\", \"input\", \"output\")) method renamed AppDriver$get_value(..., input, output, export) parameters spread input output adding support export.","code":"## {shinytest} old$getValue(\"myinput\")  ## {shinytest2} new$get_value(input = \"myinput\") # Equivalent to new$get_values(input = \"myinput\")$input$myinput"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergeturl","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getUrl()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getUrl() method renamed AppDriver$get_url().","code":"## {shinytest} old$getUrl()  ## {shinytest2} new$get_url()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversetinputs","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$setInputs()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$setInputs(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000, allowInputNoBinding_ = FALSE, priority_ = c(\"input\", \"event\")) method name renamed AppDriver$get_values() parameters snake_case’ed. value_ support removed, functionality can achieved via call AppDriver$get_values() call AppDriver$set_inputs().","code":"## {shinytest} getValuesResult <- old$setInputs(life = 42)  ## {shinytest2} new$set_inputs(life = 42) get_values_result <- new$get_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetwindowsize-shinydriversetwindowsize","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$getWindowSize(), ShinyDriver$setWindowSize()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getWindowSize() * ShinyDriver$setWindowSize(width, height) methods renamed AppDriver$get_window_size() AppDriver$set_window_size(width, height) respectively.","code":"## {shinytest} old$getWindowSize() old$setWindowSize(width = 1024, height = 768)  ## {shinytest2} new$get_window_size() new$set_window_size(width = 1024, height = 768)"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivercheckuniquewidgetnames","dir":"Articles","previous_headings":"Code structure > Methods","what":"ShinyDriver$checkUniqueWidgetNames()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$checkUniqueWidgetNames() method checked make sure input output names unique. still run initialization via AppDriver$new(check_names = TRUE) issues found startup, warnings displayed. exported method upgraded expectation version renamed AppDriver$expect_unique_names().","code":"## {shinytest} old$checkUniqueWidgetNames()  ## {shinytest2} new$expect_unique_names()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"snapshots","dir":"Articles","previous_headings":"Code structure","what":"Snapshots","title":"Migrating from shinytest","text":"Snapshots now handled testthat. leverage , use AppDriver$expect_*() methods assert value consistent many testing executions.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshotinit","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshotInit()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshotInit(path, screenshot = TRUE) method moved parameters: AppDriver$new(name = path). Screenshots testthat snapshots allowed AppDriver$new(variant=) value provided. variant similar suffix value shinytest::testApp(suffix=).","code":"## {shinytest} old$snapshotInit(\"mytest\")  ## {shinytest2} new <- AppDriver$new(name = \"mytest\", variant = NULL) # Suggested new <- AppDriver$new(name = \"mytest\", variant = platform_variant())"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshot","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshot()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshot(items = NULL, filename = NULL, screenshot = NULL) method expect screenshot expect values consistent. method longer exists shinytest2 broken two methods must called independently: AppDriver$expect_screenshot() AppDriver$expect_values(). AppDriver$expect_values() (default) take debug screenshot never fail expectation. allows historical record (version control) app looked like constantly battle false-positive screenshot failures. single output value supplied AppDriver$expect_values(), debug screenshot zoomed output value.","code":"## {shinytest} old$snapshot() old$snapshot(items = list(output = \"clickcount\"))  ## {shinytest2} # Must supply `variant=` to be able to call `AppDriver$expect_screenshot()`, even if it is `NULL` new <- AppDriver$new(path_to_app, variant = NULL) new$expect_screenshot(); new$expect_values() new$expect_screenshot(); new$expect_values(output = \"clickcount\")  # Suggested; new <- AppDriver$new(path_to_app) new$expect_values()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivertakescreenshot","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$takeScreenshot()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$takeScreenshot(file = NULL, id = NULL, parent = FALSE) method renamed AppDriver$get_screenshot(file), id parent parameters removed. use selector, set AppDriver$get_screenshot(myfile, selector = \".custom-selector\") screenshot_args directly.","code":"## {shinytest} old$takeScreenshot(\"myfile1.png\") old$takeScreenshot(\"myfile2.png\", id = \"myid\")  ## {shinytest2} new$get_screenshot(\"myfile1.png\") new$get_screenshot(\"myfile2.png\", selector = \"#myid\") new$get_screenshot(\"myfile2.png\", screenshot_args = list(selector = \"#myid\"))"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriversnapshotdownload","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$snapshotDownload()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$snapshotDownload(id, filename) method renamed AppDriver$expect_download(id, filename).","code":"## {shinytest} old$snapshotDownload(\"mylinkid\")  ## {shinytest2} new$expect_download(\"mylinkid\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverstop","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$stop()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$stop() method stayed ! 🥳. shinytest2, also stop [ChromeSession] instance clean temporary Shiny log files.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriveruploadfile","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$uploadFile()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$uploadFile(..., wait_ = TRUE, values_ = TRUE, timeout_ = 3 * 1000) method renamed AppDriver$upload_file(...), similar AppDriver$set_inputs(), support ShinyDriver$uploadFile(values_ =) removed.","code":"## {shinytest} old$uploadFile(myFileInput = \"myfile.txt\")  ## {shinytest2} new$upload_file(myFileInput = \"myfile.txt\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitfor","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitFor()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitFor(expr, checkInterval = 100, timeout = 3000) method renamed parameters reordered AppDriver$wait_for_js(script, timeout, interval). Like JavaScript methods shinytest2, script needs explicity return value.","code":"## {shinytest} old$waitFor(\"$('#myid').length > 0\")  ## {shinytest2} new$wait_for_js(\"$('#myid').length > 0\");"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitforshiny","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitForShiny()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitForShiny() method upgraded AppDriver$wait_for_idle(duration = 500, timeout = 30 * 1000). ShinyDriver$waitForShiny() method waited single instance time stated Shiny longer busy. new method wait Shiny “idle” continuous stretch time. useful wait Shiny idle set duration avoid situations dynamic UI needs calculate new outputs given new input information.","code":"## {shinytest} old$waitForShiny()  ## {shinytest2} # Equivalent new$wait_for_idle(duration = 0, timeout = 3 * 1000) # Suggested (Shiny must become continuously idle for at least 500ms within 30s new$wait_for_idle()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverwaitforvalue","dir":"Articles","previous_headings":"Code structure > Snapshots","what":"ShinyDriver$waitForValue()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$waitForValue(name, ignore = list(NULL, \"\"), iotype = c(\"input\", \"output\", \"export\"), timeout = 10000, checkInterval = 400): (underutilized) method name/iotype spread separate input, output, export parameters. one input/output/export value may supplied AppDriver object. timeout increased 15 seconds. methods still poll Shiny application set interval corresponding value something ignored set values.","code":"## {shinytest} old$waitForValue(\"myslider\") old$waitForValue(\"mydynamicplot\", iotype = \"output\")  ## {shinytest2} new$wait_for_value(\"myslider\"); new$wait_for_value(input = \"myslider\") new$wait_for_value(output = \"mydynamicplot\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"elements-widgets","dir":"Articles","previous_headings":"Code structure","what":"Elements / Widgets","title":"Migrating from shinytest","text":"Direct element Widget support shinytest2 drastically reduced. ability execute JavaScript function via $get_js(script) $run_js(script), now possible reproduce many methods provided shinytest.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverfindelement-shinydriverfindelements-shinydriverfindwidget","dir":"Articles","previous_headings":"Code structure > Elements / Widgets","what":"ShinyDriver$findElement(), ShinyDriver$findElements(), ShinyDriver$findWidget()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$findElement(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL) * ShinyDriver$findElements(css = NULL, linkText = NULL, partialLinkText = NULL, xpath = NULL) * ShinyDriver$findWidget(name, iotype = c(\"auto\", \"input\", \"output\")) methods removed. suggested use JavaScript code directly use newer helper methods.","code":"## {shinytest} old$findElement(\"#mybutton\")$click() old$findElement(\"#mybutton\")$getText() old$findElement(\"#mybutton\")$getCssValue(\"color\")  ## {shinytest2} new$get_text(selector = \"#mybutton\") new$click(selector = \"#mybutton\") # No direct equivalent method. Using JavaScript instead new$get_js('$(\"#mybutton\").css(\"color\")')"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetsource-shinydrivergettitle","dir":"Articles","previous_headings":"Code structure > Elements / Widgets","what":"ShinyDriver$getSource(), ShinyDriver$getTitle()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getSource() * ShinyDriver$getTitle() methods removed. suggested use JavaScript code directly use newer helper methods.","code":"## {shinytest} old$getSource() old$getTitle()  ## {shinytest2} new$get_html(\"html\", outer_html = TRUE) new$get_js(\"window.document.title;\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"testing-setup","dir":"Articles","previous_headings":"Code structure","what":"Testing setup","title":"Migrating from shinytest","text":"shinytest2 heavily integrated testthat testing framework. Similar shinytest, snapshots recorded recorded via testthat snapshots. information robustness different testing approaches, please see Robust testing vignette. ShinyDriver$new(suffix=): Please use AppDriver$new(variant=).","code":"## {shinytest} old <- ShinyDriver$new(path_to_app, suffix = \"macos-4.1\")  ## {shinytest2} new <- AppDriver$new(path_to_app, variant = \"macos-4.1\")"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetrelativepathtoapp-shinydrivergettestsdir","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$getRelativePathToApp(), ShinyDriver$getTestsDir()","title":"Migrating from shinytest","text":"Signatures: * ShinyDriver$getRelativePathToApp() * ShinyDriver$getTestsDir() methods removed longer needed given execution shinytest2 testing always done within testthat testing framework.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydrivergetsnapshotdir","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$getSnapshotDir()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$getSnapshotDir() method removed testthat uses ./_snaps directory store snapshot outputs.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"shinydriverexpectupdate","dir":"Articles","previous_headings":"Code structure > Testing setup","what":"ShinyDriver$expectUpdate()","title":"Migrating from shinytest","text":"Signature: ShinyDriver$expectUpdate(output, ..., timeout = 3000, iotype = c(\"auto\", \"input\", \"output\")) method longer supported. knowing output value updated, uncertain new value . possibly useful, robust therefore recommended. testing methods explored. Equivalent code provided legacy support","code":"## {shinytest} old$expectUpdate(\"myoutput\", myinput = 42)  ## {shinytest2} (equivalent code) myoutput_prior <- new$get_values(output = \"myoutput\") new$set_inputs(myinput = 42) testthat::expect_failure(   testthat::expect_equal(     new$get_values(output = \"myoutput\"),     myoutput_prior   ) )"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"debugging","dir":"Articles","previous_headings":"Code structure","what":"Debugging","title":"Migrating from shinytest","text":"Debugging shinytest2 unified enabled times. shinytest debugging methods removed favor AppDriver$get_logs() returns similarly shaped tibble ShinyDriver$getDebugLog()’s data.frame. columns altered generic type broken two columns: location level. ShinyDriver$getDebugLog(), ShinyDriver$getEventLog(): Now use AppDriver$get_logs(). ShinyDriver$logEvent(event, ...): Messages can still recorded using AppDriver$log_message(text), ... values longer supported. ShinyDriver$enableDebugLogMessages(enable = TRUE): longer used. messages always recorded. options = list(shiny.trace = TRUE) set initializing AppDriver object, WebSocket traffic recorded.","code":"## {shinytest} old$getDebugLog(); old$getEventLog() old$logEvent(\"Creating report\")  ## {shinytest2} new$get_logs() old$log_message(\"Creating report\") ## {shinytest2} # Record all websocket traffic. Caution!! This is very verbose!! new <- AppDriver$new(path_to_app, options = list(shiny.trace = TRUE)) new$get_logs()"},{"path":"https://rstudio.github.io/shinytest2/articles/z-migration.html","id":"other-removed-methods","dir":"Articles","previous_headings":"Code structure","what":"Other removed methods","title":"Migrating from shinytest","text":"ShinyDriver$setValue(name, value, iotype): set output value, must perfomed setting input value render methods set output value. set input value, use AppDriver$set_inputs(). ShinyDriver$listWidgets(): method removed can achieved getting names existing values: AppDriver$get_values(). ShinyDriver$clone(): AppDriver support cloning. (underlying ChromoteSession support cloning, AppDriver can support cloning.) ShinyDriver$goBack(), ShinyDriver$refresh(): method removed, can achieved AppDriver$run_js(script). ShinyDriver$getAppDir(), ShinyDriver$getAppFilename(), ShinyDriver$isRmd(): AppDriver$get_dir() method still supported given AppDriver$new(app_dir=) single directory path. methods removed functionality make sense within shinytest2. ShinyDriver$sendKeys(name, keys): method removed currently easy alternative. familiar key code values, can trigger jQuery AppDriver$run_js(script).","code":"## {shinytest} old$setValue(\"myinput\", 42)  ## {shinytest2} new$set_inputs(myinput = 42) ## {shinytest} old$listWidgets()  ## {shinytest2} lapply(new$get_values(), names) ## {shinytest} old$goBack() old$refresh()  ## {shinytest2} # Go back new$run_js(\"window.history.back();\") # Refresh page new$run_js(\"window.location.reload();\") ## {shinytest} old$isRmd() old$getAppDir() old$getAppFilename()  ## {shinytest2} app_dir <- new$get_dir() rmd_files <- fs::dir_ls(new$get_dir(), regexp = \"\\\\.[Rr]md$\") is_rmd <- length(rmd_files) >= 1 app_filename <- if (has_rmd) fs::path_file(rmd_files[1]) else NULL ## {shinytest} old$sendKeys(\"myinput\", webdriver::keys$enter)  ## {shinytest2} new$run_js(\"$('#myinput').trigger({type: 'keypress', which: 13, keyCode: 13});\")"},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"what-does-it-mean-when-i-run-test_app-and-it-says-server-did-not-update-any-output-values-within-3-seconds","dir":"Articles","previous_headings":"","what":"What does it mean when I run test_app() and it says, “Server did not update any output values within 3 seconds”?","title":"Frequently Asked Questions","text":"full message : happens setting input value result output changing. shinytest2 normally assumes call app$set_inputs(), setting input also result changed output, test driver process wait output change moving next step test script. outputs change within timeout period (defaults 3 seconds), prints message. , application, expect setting particular input immediately result output changes, call app$set_inputs() wait_=FALSE. hand, expect setting input result output change, time exceeds timeout, can call app$set_inputs() , example, timeout_ = 10 * 1000.","code":"Server did not update any output values within 3 seconds. If this is expected, use `wait_ = FALSE` or increase the value of `timeout_`."},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"some-input-values-are-not-set-right-after-calling-appset_inputs--how-do-i-wait-for-them","dir":"Articles","previous_headings":"","what":"Some input values are not set right after calling app$set_inputs(). How do I wait for them?","title":"Frequently Asked Questions","text":"situations, input value set, shinytest2 wait next value sent server. (See question section Testing depth. However, dealing dynamic UI inputs, htmlwidgets, even selectize inputs, input values set first output change. Use app$wait_for_value(input = NAME, ignore = list(VALUE_1, ...., VALUE_N)) wait particular input (output) value available (non-invalid value).","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"how-can-my-app-detect-if-its-running-in-shinytest2","dir":"Articles","previous_headings":"","what":"How can my app detect if it’s running in {shinytest2}?","title":"Frequently Asked Questions","text":"Sometimes can useful alter behavior application ’s tested. detect ’s tested, can use isTRUE(getOption(\"shiny.testmode\")), :","code":"if (isTRUE(getOption(\"shiny.testmode\"))) {    # Do something special here }"},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"how-can-i-get-the-objects-from-files-in-my-the-r-folder-into-the-testing-environment","dir":"Articles","previous_headings":"","what":"How can I get the objects from files in my the R folder into the testing environment?","title":"Frequently Asked Questions","text":"Loading support environment Shiny application requires call shinytest2::load_app_env() ./tests/testthat/setup.R. method load global.R R files testing environment, similar testing package R code. automatically performed may costly load support environment.","code":""},{"path":"https://rstudio.github.io/shinytest2/articles/zzz-faq.html","id":"can-i-modify-the-input-and-output-values-that-are-recorded-in-snapshots","dir":"Articles","previous_headings":"","what":"Can I modify the input and output values that are recorded in snapshots?","title":"Frequently Asked Questions","text":"kinds outputs, problematic record raw value directly JSON snapshot. output might large (e.g., image data large table), may contain randomly-generated values specific value unimportant testing (randomly-generated DOM element IDs). situations, can use output preprocessor function. commonly done author component used application, although can also done application author. output preprocessor function passed object representing output value, return value. problem value large, preprocessor function can modify value hashing returning hash. problem value contains random values, preprocessor function can replace random values fixed ones. add output preprocessor, use shiny::snapshotPreprocessOutput() modify output renderer. example, see section renderDataTable() function. takes object returned renderDataTable(), modifies adding output preprocessor removes strings contain random values. outputs (notably htmlwidgets), output value text string containing JSON, want modify JSON, either (1) text processing JSON, (2) convert JSON R object, modify R object, convert R object back JSON. plotly R package uses method renderPlotly(). examples modify output renderer inside output renderer function, done author component. also possible application author modify renderer something like following: output JSON snapshot : (example just illustration purposes. Note example, screenshots still change time test run, better solutions, like setting random seed.) Input values can face issues, can also modified shiny::snapshotPreprocessInput().","code":"shinyApp(   ui = fluidPage(     verbatimTextOutput(\"random\")   ),   server = function(input, output, session) {     output$random <- snapshotPreprocessOutput(       renderText({         paste(\"This is a random number:\", rnorm(1))       }),       function(value) {         sub(\"[0-9.]+$\", \"<a random number>\", value)       }     )   } ) \"output\": {     \"random\": \"This is a random number: <a random number>\"   }"},{"path":"https://rstudio.github.io/shinytest2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Barret Schloerke. Maintainer, author. RStudio. Copyright holder, funder. Winston Chang. Contributor.            Original author rstudio/shinytest Gábor Csárdi. Contributor.            Original author rstudio/shinytest Hadley Wickham. Contributor.            Original author rstudio/shinytest Mango Solutions. Copyright holder, conceptor.            Original author rstudio/shinytest","code":""},{"path":"https://rstudio.github.io/shinytest2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Schloerke B (2022). shinytest2: Testing Shiny Applications. R package version 0.0.0.9002, https://github.com/rstudio/shinytest2.","code":"@Manual{,   title = {shinytest2: Testing for Shiny Applications},   author = {Barret Schloerke},   year = {2022},   note = {R package version 0.0.0.9002},   url = {https://github.com/rstudio/shinytest2}, }"},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"shinytest2","dir":"","previous_headings":"","what":"Testing for Shiny Applications","title":"Testing for Shiny Applications","text":"🚩🚩 {shinytest2} beta developement. Please report bugs feedback https://github.com/rstudio/shinytest2/issues 🚩🚩 Manually testing Shiny applications often laborious, inconsistent, doesn’t scale well. Whether developing new features, fixing bug(s), simply upgrading dependencies serious app mistakes real consequences, critical know regressions introduced. shinytest2 provides streamlined toolkit unit testing Shiny applications seamlessly integrates popular {testthat} framework unit testing R code. shinytest2 uses {chromote} render applications headless Chrome browser. chromote allows live preview, better debugging tools, /simply using modern JavaScript/CSS. simply recording actions code extending test particular aspects application, result fewer bugs confidence future Shiny application development.","code":""},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Testing for Shiny Applications","text":"can install development version {shinytest2} GitHub : Please check Getting Started article example usage.","code":"remotes::install_github(\"rstudio/shinytest2\")"},{"path":"https://rstudio.github.io/shinytest2/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Testing for Shiny Applications","text":"easiest way get started calling shinytest2::record_test() app directory. open Shiny application record actions code. programmatically create test, call shinytest2::use_shinytest2_test(). Call shinytest2::use_shinytest2() create initial value test file set infrastructure may need.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":null,"dir":"Reference","previous_headings":"","what":"Drive a Shiny application — AppDriver","title":"Drive a Shiny application — AppDriver","text":"class starts Shiny app new R session, along chromote's headless browser can used simulate user actions. provides full simulation Shiny app can test user interactions live app. Methods described ordered perceived popularity. Expect methods grouped next corresponding get methods.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"vignettes","dir":"Reference","previous_headings":"","what":"Vignettes","title":"Drive a Shiny application — AppDriver","text":"Please see Testing depth details different expectation methods. Please see Robust testing details cost / benefits expectation method.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"test-mode","dir":"Reference","previous_headings":"","what":"Test mode","title":"Drive a Shiny application — AppDriver","text":"AppDriver retrieve values Shiny app, sure set shiny::runApp(test.mode = TRUE) running Shiny app. deploying Shiny app control call shiny::runApp(), can set options(shiny.testmode = TRUE) .Rprofile file within Shiny app directory.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"start-up-failure","dir":"Reference","previous_headings":"","what":"Start-up failure","title":"Drive a Shiny application — AppDriver","text":"app throws error initialization, AppDriver stored rlang::last_error()$app. allows \"failure initialize\" signaled also allowing app retrieved initialization error thrown.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"exporting-reactive-values","dir":"Reference","previous_headings":"","what":"Exporting reactive values","title":"Drive a Shiny application — AppDriver","text":"Reactive values within Shiny application can exported using method: shiny::exportTestValues(). utilized method exposes internal values app without needing create corresponding input value output value. example:  exported test values exposed shiny::runApp(test.mode = TRUE) set.  shinytest2 sets variable running Shiny based app document.","code":"library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app) init_vals <- app$get_values() str(init_vals) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"testthat-wrappers","dir":"Reference","previous_headings":"","what":"testthat wrappers","title":"Drive a Shiny application — AppDriver","text":"two main expectation methods: $expect_values() $expect_screenshot() eventually wrap testthat::expect_snapshot_file(). underlying logic similar :  update snapshot values, need run variation testthat::snapshot_review().","code":"## Expect values tmpfile <- tempfile(fileext = \".json\") jsonlite::write_json(app$get_values(), tmpfile) expect_snapshot_file(   tmpfile,   variant = app$get_variant(),   compare = testthat::compare_file_text,   cran = cran )   ## Expect screenshot tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) expect_snapshot_file(   tmpfile,   variant = app$get_variant(),   compare = testthat::compare_file_binary,   cran = cran )"},{"path":[]},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Drive a Shiny application — AppDriver","text":"AppDriver$new() AppDriver$view() AppDriver$click() AppDriver$set_inputs() AppDriver$upload_file() AppDriver$expect_values() AppDriver$get_value() AppDriver$get_values() AppDriver$expect_download() AppDriver$get_download() AppDriver$expect_text() AppDriver$get_text() AppDriver$expect_html() AppDriver$get_html() AppDriver$expect_js() AppDriver$get_js() AppDriver$run_js() AppDriver$expect_screenshot() AppDriver$get_screenshot() AppDriver$wait_for_idle() AppDriver$wait_for_value() AppDriver$wait_for_js() AppDriver$expect_unique_names() AppDriver$get_dir() AppDriver$get_url() AppDriver$get_window_size() AppDriver$set_window_size() AppDriver$get_chromote_session() AppDriver$get_variant() AppDriver$get_logs() AppDriver$log_message() AppDriver$stop()","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Drive a Shiny application — AppDriver","text":"Initialize AppDriver object","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$new(   app_dir = testthat::test_path(\"../../\"),   ...,   name = NULL,   variant = missing_arg(),   seed = NULL,   load_timeout = NULL,   wait = TRUE,   screenshot_args = missing_arg(),   expect_values_screenshot_args = TRUE,   check_names = TRUE,   view = missing_arg(),   height = NULL,   width = NULL,   clean_logs = TRUE,   shiny_args = list(),   render_args = NULL,   options = list() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"app_dir Directory containing Shiny application run-time Shiny R Markdown document. default, retrieves test_path(\"../../\") allow interactive testing usage. Shiny application URL can provided, however snapshots saved current directory. ... Must empty. Allows parameter expansion. name Prefix value use saving testthat snapshot files. Ex: NAME-001.json. Name must unique saving multiple snapshots within testing file. Otherwise, two different AppDriver objects referencing files. variant -NULL, results saved _snaps/variant/test.md, variant` must single string alphanumeric characters suitable use directory name. can variants deal cases snapshot output varies want capture test variations. Common use cases include variations operating system, R version, version key dependency. example usage, see platform_variant(). seed optional random seed use starting application. apps use R's random number generator, can make behavior repeatable. load_timeout long wait app load, ms. includes time start R. Defaults 10s running locally 20s running CI. wait TRUE, $wait_for_idle(duration = 200, timeout = load_timeout) called app connected new session, blocking Shiny app idle 200ms. screenshot_args Default set arguments pass chromote::ChromoteSession's $get_screenshot() method taking screnshots within $expect_screenshot(). disable screenshots default, set FALSE. expect_values_screenshot_args value screenshot_args producing debug screenshot $expect_values(). disable debug screenshots default, set FALSE. check_names Check widget names unique application initially loads? duplicate names found initialization, warning displayed. view Opens ChromoteSession interactive browser tab attempting navigate Shiny app. height, width Window size use opening ChromoteSession. height width values must non-null values used. clean_logs Whether remove stdout stderr Shiny app logs AppDriver object garbage collected. shiny_args list options pass shiny::runApp(). Ex: list(port = 8080). render_args Passed rmarkdown::run(render_args=) interactive .Rmds. Ex: list(quiet = TRUE) options list base::options() set Shiny application's child R process. See shiny::shinyOptions() inspiration. shiny.trace = TRUE, WebSocket traffic captured chromote time-stamped logging purposes.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"object class AppDriver many methods described documentation.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ # Create an AppDriver from the Shiny app in the current directory app <- AppDriver()  # Create an AppDriver object from a different Shiny app directory example_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver(example_app)  # Expect consistent inital values app$expect_values() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-view-","dir":"Reference","previous_headings":"","what":"Method view()","title":"Drive a Shiny application — AppDriver","text":"View Shiny application Calls $view() ChromoteSession object view Shiny application Chrome browser. method helpful debugging writing tests.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$view()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-1","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ # Open app in Chrome app$view() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-click-","dir":"Reference","previous_headings":"","what":"Method click()","title":"Drive a Shiny application — AppDriver","text":"Click element Find Shiny input/output value DOM CSS selector click using DOM method TAG.click(). method can used click input buttons elements need simulate click action.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$click(   input = missing_arg(),   output = missing_arg(),   selector = missing_arg(),   ... )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"input, output, selector name Shiny input/output value DOM CSS selector. one may used. ... input used, extra arguments passed $set_inputs(!!input := \"click\", ...). means AppDriver wait output updated within specified timeout_. clicking content, ... must empty.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-2","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  tmpfile <- write.csv(cars, \"cars.csv\") app$upload_file(file1 = tmpfile) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-set-inputs-","dir":"Reference","previous_headings":"","what":"Method set_inputs()","title":"Drive a Shiny application — AppDriver","text":"Set input values Set Shiny inputs sending value Chrome browser programaticly updating values. Given wait_ = TRUE, method return output value updated.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$set_inputs(   ...,   wait_ = TRUE,   timeout_ = 3 * 1000,   allow_no_input_binding_ = FALSE,   priority_ = c(\"input\", \"event\") )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Name-value pairs, component_name_1 = value_1, component_name_2 = value_2 etc. Input name component_name_1 assigned value value_1. wait_ Wait reactive updates completed? timeout_ Amount time wait giving (milliseconds). allow_no_input_binding_ setting value input, allow set value input even input input binding. useful replicate behavior like hovering plotly plot. priority_ Sets event priority. expert use : see https://shiny.rstudio.com/articles/communicating--js.html#values-vs-events details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-3","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-upload-file-","dir":"Reference","previous_headings":"","what":"Method upload_file()","title":"Drive a Shiny application — AppDriver","text":"Upload file Uploads file specified file input.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$upload_file(..., wait_ = TRUE, timeout_ = 3 * 1000)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Name-path pair, e.g. component_name = file_path. file located file_path uploaded file input name component_name. wait_ Wait reactive updates completed? timeout_ Amount time wait giving (milliseconds).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-4","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/09_upload\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save example file tmpfile <- tempfile(fileext = \".csv\") write.csv(cars, tmpfile, row.names = FALSE)  # Upload file to input named: file1 app$upload_file(file1 = tmpfile) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-values-","dir":"Reference","previous_headings":"","what":"Method expect_values()","title":"Drive a Shiny application — AppDriver","text":"Expect input, output, export values JSON snapshot saved given results underlying call $get_values(). Note, values contain environments values trouble serializing may work well. Instead, objects manually inspected components tested individually. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_values(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   screenshot_args = missing_arg(),   name = NULL,   cran = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export Depending parameters supplied, different return values can occur: * input, output, export missing, values included snapshot. * least one input, output, export specified, requested values included snapshot. values supplied variable can : * character vector specific names include snapshot. * TRUE request values type included snapshot. * Anything else (e.g. NULL FALSE) result parameter ignored. screenshot_args value passed along $expect_screenshot() resulting snapshot expectation ignored. missing, default value $new(expect_values_screenshot_args=). final value can either : TRUE: screenshot whole page taken delay FALSE: screenshot taken named list arguments. arguments passed directly chromote::ChromoteSession's $get_screenshot() method. selector delay default \"html\" 0 respectively. name file name used snapshot. file extension overwritten .json. default, name supplied app initialization counter used (e.g. \"NAME-001.json\"). cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"result snapshot expectation","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-5","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Snapshot all known values app$expect_values()  # Snapshot only `export` values app$expect_values(export = TRUE)  # Snapshot values `\"A\"` from `input` and `\"C\"` from `output` app$expect_values(input = \"A\", output = \"C\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-value-","dir":"Reference","previous_headings":"","what":"Method get_value()","title":"Drive a Shiny application — AppDriver","text":"Get single input, output, export value helper function around $get_values() retrieve single input, output, export value. single input, output, export value can used. Note, values contain environments values trouble serializing RDS may work well.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_value(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   hash_images = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export One variable contain single string value. one value specified values specified, error thrown. hash_images TRUE, images hashed returned. Otherwise, images return full data64 encoded value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"requested input, output, export value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-6","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path) # Retrieve a single value app$get_value(output = \"caption\") #> [1] \"mpg ~ cyl\" # Equivalent code using `$get_values()` app$get_values(output = \"caption\")$output$caption #> [1] \"mpg ~ cyl\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-values-","dir":"Reference","previous_headings":"","what":"Method get_values()","title":"Drive a Shiny application — AppDriver","text":"Get input, output, export values Retrieves list known input, output, export values. method core method inspecting Shiny app. Note, values contain environments values trouble serializing may work well.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_values(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   hash_images = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export Depending parameters supplied, different return values can occur: * input, output, export missing, values included snapshot. * least one input, output, export specified, requested values included snapshot. values supplied variable can : * character vector specific names include snapshot. * TRUE request values type included snapshot. * Anything else (e.g. NULL FALSE) result parameter ignored. hash_images TRUE, images hashed returned. Otherwise, images return full data64 encoded value.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"named list inputs, outputs, export values.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-7","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Show all known values str(app$get_values()) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get only `export` values str(app$get_values(export = TRUE)) #> List of 1 #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get values `\"A\"` from `input` and `\"C\"` from `output` str(app$get_values(input = \"A\", output = \"C\")) #> List of 2 #> $ input :List of 1 #> ..$ A: int 3 #> $ output:List of 1 #> ..$ C: chr \"5\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-download-","dir":"Reference","previous_headings":"","what":"Method expect_download()","title":"Drive a Shiny application — AppDriver","text":"Expect downloadable file Given shiny::downloadButton()/shiny::downloadLink() output ID, corresponding file downloaded saved snapshot file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_download(   output,   ...,   compare = NULL,   name = NULL,   cran = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-7","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"output output ID shiny::downloadButton()/shiny::downloadLink() ... Must empty. Allows parameter expansion. compare value passed testthat::expect_snapshot_file(). default set NULL default testthat::compare_file_text name extension .r, .R, .Rmd, .md, .txt, otherwise uses testthat::compare_file_binary. name File name save file (including file name extension). default, NULL, generates ascending sequence names: 001.download, 002.download, etc. cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-8","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save snapshot of rock.csv as 001.download # Save snapshot value of `rock.csv` to capture default file name app$expect_download(\"downloadData\", compare = testthat::compare_file_text) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-download-","dir":"Reference","previous_headings":"","what":"Method get_download()","title":"Drive a Shiny application — AppDriver","text":"Get downloadable file Given shiny::downloadButton()/shiny::downloadLink() output ID, corresponding file downloaded saved file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_download(output, filename = NULL)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-8","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"output output ID shiny::downloadButton()/shiny::downloadLink() filename File path save downloaded file .","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"$get_download() return final save location file. location can change depending value filename response headers. Location logic: filename NULL, filename returned. content-disposition filename provided, temp file containing filename returned. Otherwise, tempfile ending .download returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-9","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Get rock.csv as a tempfile app$get_download(\"downloadData\") #> [1] \"/TEMP/PATH/rock.csv\"  # Get rock.csv as a \"./myfile.csv\" app$get_download(\"downloadData\", filename = \"./myfile.csv\") #> [1] \"./myfile.csv\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-text-","dir":"Reference","previous_headings":"","what":"Method expect_text()","title":"Drive a Shiny application — AppDriver","text":"Expect snapshot UI text $expect_text() extract text value matching elements via TAG.textContent store snapshot file. method robust internal package change text values maintained. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. possible, use $expect_text() $expect_html() allow package authors room alter HTML structures. resulting array TAG.textContent values found stored snapshot file. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_text(selector, ..., cran = FALSE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-9","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"selector DOM CSS selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-10","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  # Make a snapshot of `\"Hello Shiny!\"` app$expect_text(\"h2\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-text-","dir":"Reference","previous_headings":"","what":"Method get_text()","title":"Drive a Shiny application — AppDriver","text":"Get UI text $get_text() extract text value matching elements via TAG.textContent. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_text(selector)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-10","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"selector DOM CSS selector passed document.querySelectorAll()","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"vector character values","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-11","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  app$get_text(\"h2\") #> [1] \"Hello Shiny!\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-html-","dir":"Reference","previous_headings":"","what":"Method expect_html()","title":"Drive a Shiny application — AppDriver","text":"Expect snapshot UI HTML $expect_html() extract full DOM structures matching element store snapshot file. method captures internal DOM structure may brittle changes external authors dependencies. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. possible, use $expect_text() $expect_html() allow package authors room alter HTML structures. resulting array TAG.textContent values found stored snapshot file. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_html(selector, ..., outer_html = TRUE, cran = FALSE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-11","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"selector DOM selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. outer_html TRUE (default), full DOM structure returned (TAG.outerHTML). FALSE, full DOM structure child elements returned (TAG.innerHTML). cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-12","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path) # Save a snapshot of the `caption` output app$expect_html(\"#caption\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-html-","dir":"Reference","previous_headings":"","what":"Method get_html()","title":"Drive a Shiny application — AppDriver","text":"Get UI HTML $get() extract full DOM structures matching element. method captures internal DOM structure may brittle changes external authors dependencies. Note, method retrieve <input /> value's text content, e.g. text inputs text areas, input values stored live HTML. Please see Robust testing details.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_html(selector, ..., outer_html = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-12","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"selector DOM selector passed document.querySelectorAll() ... Must empty. Allows parameter expansion. outer_html TRUE, full DOM structure returned (TAG.outerHTML). FALSE, full DOM structure child elements returned (TAG.innerHTML).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-13","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/03_reactivity\", package = \"shiny\") app <- AppDriver$new(app_path, check_names = FALSE) app$set_inputs(caption = \"Custom value!\") cat(app$get_html(\".shiny-input-container\")[1]) #> <div class=\"form-group shiny-input-container\"> #>   <label class=\"control-label\" id=\"caption-label\" for=\"caption\">Caption:<\/label> #>   <input id=\"caption\" type=\"text\" class=\"form-control shiny-bound-input\" value=\"Data Summary\"> #> <\/div> ## ^^ No update to the DOM of `caption` }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-js-","dir":"Reference","previous_headings":"","what":"Method expect_js()","title":"Drive a Shiny application — AppDriver","text":"Expect snapshot JavaScript script output building block function may called functions. example, $expect_text() $expect_html() thin wrappers around function. script executed, JSON result saved snapshot file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-14","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = 15 * 1000,   pre_snapshot = NULL,   cran = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-13","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"script string containing JavaScript script executed. ... Must empty. Allows parameter expansion. file file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds). pre_snapshot function called result script taking snapshot. $expect_html() $expect_text() use unlist(). cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-14","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  # Track how many clicks are given to `#update` button app$run_js(\"   window.test_counter = 0;   $('#update').click(() => window.test_counter++); \") app$set_inputs(obs = 20) # Click the update button, incrementing the counter app$click(\"update\") # Save a snapshot of number of clicks (1) app$expect_js(\"window.test_counter;\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-js-","dir":"Reference","previous_headings":"","what":"Method get_js()","title":"Drive a Shiny application — AppDriver","text":"Execute JavaScript code browser return result function block local R session code finished executing tick browser. Promise returned script, $get_js() wait promise resolve. JavaScript code execute asynchronously, wrap code Promise object script return atomic value. Arguments inserted script access arguments. can done commands like paste(). using glue::glue(), sure use uncommon .open .close values avoid doulbe { }.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-15","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = 15 * 1000 )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-14","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"script JavaScript execute. JavaScript Promise returned, R session block promise resolved return value. ... Must empty. Allows parameter expansion. file (local) file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"Result script (file contents)","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-15","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Execute JavaScript code in the app's browser app$get_js(\"1 + 1;\") #> [1] 2  # Execute a JavaScript Promise. Return the resolved value. app$get_js(\"   new Promise((resolve) => {     setTimeout(() => resolve(1 + 1), 1000)   }).   then((value) => value + 1); \") #> [1] 3  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$get_js(js_txt) #> [1] \"127.0.0.1\"  # With `glue::glue()` js_txt <- glue::glue_data(   lapply(     list(x = 40, y = 2),     jsonlite::toJSON,     auto_unbox = TRUE   ),   .open = \"<\", .close = \">\",   \"let answer = function(a, b) {\\n\",   \"  return a + b;\\n\",   \"};\\n\",   \"answer(<x>, <y>);\\n\" ) app$get_js(js_txt) #> [1] 42 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-run-js-","dir":"Reference","previous_headings":"","what":"Method run_js()","title":"Drive a Shiny application — AppDriver","text":"Execute JavaScript code browser function block local R session code finished executing tick browser. final result code ignored returned R session.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-16","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$run_js(   script = missing_arg(),   ...,   file = missing_arg(),   timeout = 15 * 1000 )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-15","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"script JavaScript execute. ... Must empty. Allows parameter expansion. file (local) file containing JavaScript code read used script. one script file can specified. timeout Amount time wait giving (milliseconds).","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-16","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Get JavaScript answer from the app's browser app$get_js(\"1 + 1\") #> [1] 2 # Execute JavaScript code in the app's browser app$run_js(\"1 + 1\") # (Returns `app` invisibly)  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$run_js(js_txt) app$get_js(js_txt) #> [1] \"127.0.0.1\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-screenshot-","dir":"Reference","previous_headings":"","what":"Method expect_screenshot()","title":"Drive a Shiny application — AppDriver","text":"Expect screenshot Shiny application method takes screenshot application (selector area) compares image expected image. Please aware method brittle changes outside Shiny application. changes can include: running different R version running different operating system using different default system font using different package versions differences explicitly clear working plots. Unless absolutely necessary application consistency, strongly recommended use expectation methods.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-17","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_screenshot(   ...,   screenshot_args = missing_arg(),   delay = missing_arg(),   selector = missing_arg(),   name = NULL,   cran = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-16","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Must empty. Allows parameter expansion. screenshot_args named list arguments passed along chromote::ChromoteSession's $get_screenshot() method. missing, value default $new(screenshot_args=). value : TRUE: screenshot whole page taken delay named list arguments: Arguments passed directly chromote::ChromoteSession's $get_screenshot() method. selector delay default \"html\" 0 respectively. FALSE provided, parameter ignored screenshot taken default behavior. delay number milliseconds wait taking screenshot. value can either supplied delay screenshot_args's delay slot. delay parameter preference. selector selector CSS selector used select portion page captured. value can either supplied selector screenshot_args's selector slot. selector parameter preference. name file name used snapshot. file extension overwritten .png. default, name supplied app initialization counter used (e.g. \"NAME-001.png\"). cran expectations verified CRAN? default, snapshot tests tend fragile often rely minor details dependencies.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-17","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path, variant = platform_variant())  # Expect a full size screenshot app$expect_screenshot()  # Very brittle test app$expect_screenshot(selector = \"#distPlot\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-screenshot-","dir":"Reference","previous_headings":"","what":"Method get_screenshot()","title":"Drive a Shiny application — AppDriver","text":"Take screenshot Take screenshot Shiny application.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-18","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_screenshot(   file = NULL,   ...,   screenshot_args = missing_arg(),   delay = missing_arg(),   selector = missing_arg() )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-17","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"file NULL, image displayed current Graphics Device. file path, screenshot saved file. ... Must empty. Allows parameter expansion. screenshot_args named list arguments passed along chromote::ChromoteSession's $get_screenshot() method. missing, value default $new(screenshot_args=). value : TRUE: screenshot whole page taken delay named list arguments: Arguments passed directly chromote::ChromoteSession's $get_screenshot() method. selector delay default \"html\" 0 respectively. FALSE value provided, parameter ignored screenshot taken default behavior. delay number milliseconds wait taking screenshot. value can either supplied delay screenshot_args's delay slot. delay parameter preference. selector selector CSS selector used select portion page captured. value can either supplied selector screenshot_args's selector slot. selector parameter preference.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-18","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  # Display in viewer app$get_screenshot()  # Update bins then display `\"disPlot\"` in viewer app$set_inputs(bins = 10) app$get_screenshot(selector = \"#distPlot\")  # Save screenshot to file and view it tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) showimage::show_image(tmpfile) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-idle-","dir":"Reference","previous_headings":"","what":"Method wait_for_idle()","title":"Drive a Shiny application — AppDriver","text":"Wait Shiny busy (idle) set amount time Waits Shiny busy set duration time, e.g. reactivity updating occurred. useful, example, waiting application initialize resized window $set_window_size() want make sure plot redrawing complete take screenshot. default, $new(wait = TRUE) waits Shiny busy initializing application $set_window_size(wait = TRUE) waits Shiny busy resizing window.)","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-19","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$wait_for_idle(duration = 500, timeout = 30 * 1000)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-18","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"duration long Shiny must idle (ms) unblocking R session. timeout often check condition, ms.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"invisible(self) Shiny stabilizes within timeout. Otherwise error thrown","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-19","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  pre_value <- app$get_value(output = \"distPlot\") # Update bins value app$set_inputs(bins = 10, wait_ = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value)  # --------------------- ## Change the screen size to trigger a plot update pre_value <- app$get_value(output = \"distPlot\") app$set_window_size(height = 1080, width = 1920, wait = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-value-","dir":"Reference","previous_headings":"","what":"Method wait_for_value()","title":"Drive a Shiny application — AppDriver","text":"Wait new Shiny value Waits input, output, export Shiny value one ignored values, timeout reached. single input, output, export value may used. function can useful helping determine application finished processing complex reactive situation.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-20","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$wait_for_value(   ...,   input = missing_arg(),   output = missing_arg(),   export = missing_arg(),   ignore = list(NULL, \"\"),   timeout = 15 * 1000,   interval = 400 )"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-19","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"... Must empty. Allows parameter expansion. input, output, export name input, output, export value. one parameters may used. ignore List possible values ignore checking updates. timeout long wait (ms) throwing error. interval often check condition, ms.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-8","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"Newly found value","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-20","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Dynamic output\"),     actionButton(\"display\", \"Display UI\"),     uiOutput(\"dym1\"),   ),   function(input, output) {     output$dym1 <- renderUI({       req(input$display)       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider1\", \"Slider #1\", 0, 100, 25),         uiOutput(\"dym2\")       )     })     output$dym2 <- renderUI({       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider2\", \"Slider #2\", 0, 100, 50),         \"Total:\", verbatimTextOutput(\"total\")       )     })     output$total <- renderText({       req(input$slider1, input$slider2)       input$slider1 + input$slider2     })   } )  app <- AppDriver$new(shiny_app)  # Create UI / output values app$click(\"display\") # Wait for total to be calculated (or have a non-NULL value) new_total_value <- app$wait_for_value(output = \"total\") #> [1] \"75\" app$get_value(output = \"total\") #> [1] \"75\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-wait-for-js-","dir":"Reference","previous_headings":"","what":"Method wait_for_js()","title":"Drive a Shiny application — AppDriver","text":"Wait JavaScript expression true Waits JavaScript expression evaluates true timeout exceeded.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-21","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$wait_for_js(script, timeout = 30 * 1000, interval = 100)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-20","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"script string containing JavaScript code. code must eventually return truethy value timeout error thrown. timeout long script return truethy value, ms. interval often check condition, ms.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-9","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"invisible(self) expression evaluates true without error within timeout. Otherwise error thrown","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-21","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Contrived example: # Wait until `Date.now()` returns a number that ends in a 5. (0 - 10 seconds) system.time(   app$wait_for_js(\"Math.floor((Date.now() / 1000) % 10) == 5;\") )  ## A second example where we run the contents of a JavaScript file ## and use the result to wait for a condition app$run_js(file = \"complicated_file.js\") app$wait_for_js(\"complicated_condition();\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-expect-unique-names-","dir":"Reference","previous_headings":"","what":"Method expect_unique_names()","title":"Drive a Shiny application — AppDriver","text":"Expect unique input output names. HTML duplicate input output elements matching id values, function throw error. similar AppDriver$new(check_names = TRUE), asserts warnings displayed. method throw single input single output name.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-22","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$expect_unique_names()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-22","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ shiny_app <- shinyApp(   ui = fluidPage(     # Duplicate input IDs: `\"text\"`     textInput(\"text\", \"Text 1\"),     textInput(\"text\", \"Text 2\")   ),   server = function(input, output) {     # empty   } ) # Initial checking for unique names (default behavior) app <- AppDriver$new(shiny_app, check_names = TRUE) #> Warning: #> ! Shiny inputs should have unique HTML id values. #> ℹ The following HTML id values are not unique: #> • text  # Manually assert that all names are unique app <- AppDriver$new(shiny_app, check_names = FALSE) app$expect_unique_names() #> Error: `app_check_unique_names(self, private)` threw an unexpected warning. #> Message: ! Shiny inputs should have unique HTML id values. #> ℹ The following HTML id values are not unique: #>   • text #> Class:   rlang_warning/warning/condition }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-dir-","dir":"Reference","previous_headings":"","what":"Method get_dir()","title":"Drive a Shiny application — AppDriver","text":"Retrieve Shiny app path","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-23","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_dir()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-10","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"directory containing Shiny application Shiny runtime document. URL provided app_dir initialization, current directory returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-23","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) identical(app$get_dir(), app_path) #> [1] TRUE }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-url-","dir":"Reference","previous_headings":"","what":"Method get_url()","title":"Drive a Shiny application — AppDriver","text":"Retrieve Shiny app URL","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-24","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_url()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-11","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"URL Shiny app hosted","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-24","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) browseURL(app$get_url()) }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-window-size-","dir":"Reference","previous_headings":"","what":"Method get_window_size()","title":"Drive a Shiny application — AppDriver","text":"Get window size Get current size browser window, list numeric scalars named width height.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-25","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_window_size()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-25","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) app$get_window_size() #> $width #> [1] 992 #> #> $height #> [1] 1323 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-set-window-size-","dir":"Reference","previous_headings":"","what":"Method set_window_size()","title":"Drive a Shiny application — AppDriver","text":"Sets size browser window.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-26","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$set_window_size(width, height, wait = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-21","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"width, height Height width browser, pixels. wait TRUE, $wait_for_idle() called setting window size. block width specific items (plots) need re-rendered.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-26","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") # Set init window size app <- AppDriver$new(app_path, height = 1400, width = 1000)  app$get_window_size() #> $width #> [1] 1000 #> #> $height #> [1] 1400  # Manually set the window size app$set_window_size(height = 1080, width = 1920) app$get_window_size() #> $width #> [1] 1920 #> #> $height #> [1] 1080 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-chromote-session-","dir":"Reference","previous_headings":"","what":"Method get_chromote_session()","title":"Drive a Shiny application — AppDriver","text":"Get Chromote Session Get ChromoteSession object chromote package.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-27","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_chromote_session()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-12","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"ChromoteSession R6 object","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-27","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) b <- app$get_chromote_session() b$Runtime$evaluate(\"1 + 1\") #> $result #> $result$type #> [1] \"number\" #> #> $result$value #> [1] 2 #> #> $result$description #> [1] \"2\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-variant-","dir":"Reference","previous_headings":"","what":"Method get_variant()","title":"Drive a Shiny application — AppDriver","text":"Get variant Get variant supplied initialization","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-28","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_variant()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-13","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"variant value supplied initialization NULL value supplied.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-28","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\")  app <- AppDriver$new(app_path) app$get_variant() #> NULL  app <- AppDriver$new(app_path, variant = platform_variant()) app$get_variant() #> [1] \"mac-4.1\" }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-get-logs-","dir":"Reference","previous_headings":"","what":"Method get_logs()","title":"Drive a Shiny application — AppDriver","text":"Get logs Retrieve debug logs recorded. standard debug types may used: \"shiny_console\": Displays console messages Shiny server $get_logs() called. \"browser\": Displays browser console messages $get_logs() called. \"shinytest2\": Displays messages saved window.shinytest2 object browser $get_logs() called. \"ws_messages\": Saves messages sent Shiny ","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-29","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$get_logs()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-14","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"data.frame following columns: workerid: shiny worker ID found within browser timestamp: POSIXct timestamp message location: location message found. One three values: \"shinytest2\": Occurs $log_message() called \"shiny\": stdin stdout messages Shiny server. Note message() output sent stdout. \"chromote\": Captured chromote event handlers. See console API, exception thrown, websocket sent, websocket received details level: given location, different types log levels. \"shinytest2\": \"log\"; log messages captured. \"shiny\": \"log\" \"error\"; two levels correspond stdin stdout messages. Note, message() output sent stderr recorded \"error\". \"chromote\": Correspond level JavaScript console.LEVEL() function call. Typically, \"log\"\"error\"can include\"info\", \"debug\", \"warn\". options(shiny.trace = TRUE), level recorded \"websocket\"`.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-29","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app <- AppDriver$new(system.file(\"examples/01_hello\", package = \"shiny\")) app$get_logs() # {shinytest2} R  info  11:15:20.11 Start AppDriver initialization # {shinytest2} R  info  11:15:20.11 Starting Shiny app # {shinytest2} R  info  11:15:20.99 Creating new chromote session # {shinytest2} R  info  11:15:21.14 Navigating to Shiny app # {shinytest2} R  info  11:15:21.27 Injecting shiny-tracer.js # {chromote}   JS info  11:15:21.28 shinytest2; jQuery not found # {chromote}   JS info  11:15:21.28 shinytest2; Loaded # {shinytest2} R  info  11:15:21.28 Waiting until Shiny app starts # {chromote}   JS info  11:15:21.35 shinytest2; jQuery found # {chromote}   JS info  11:15:21.35 shinytest2; Waiting for shiny session to connect # {chromote}   JS info  11:15:21.57 shinytest2; Connected # {chromote}   JS info  11:15:21.57 shinytest2; Ready # {chromote}   JS info  11:15:21.65 shinytest2; shiny:busy # {shinytest2} R  info  11:15:21.65 Shiny app started # {chromote}   JS info  11:15:21.88 shinytest2; shiny:idle # {chromote}   JS info  11:15:21.88 shinytest2; shiny:value distPlot # {shiny}      R  error ----------- Loading required package: shiny # {shiny}      R  error ----------- Running application in test mode. # {shiny}      R  error ----------- # {shiny}      R  error ----------- Listening on http://127.0.0.1:42558   # To capture all websocket traffic, set `options = list(shiny.trace = TRUE)` app <- AppDriver$new(   system.file(\"examples/01_hello\", package = \"shiny\"),   options = list(shiny.trace = TRUE) ) app$get_logs() # (long output lines have been truncated) # {shinytest2} R  info      11:09:57.43 Start AppDriver initialization # {shinytest2} R  info      11:09:57.43 Starting Shiny app # {shinytest2} R  info      11:09:58.27 Creating new chromote session # {shinytest2} R  info      11:09:58.40 Navigating to Shiny app # {shinytest2} R  info      11:09:58.53 Injecting shiny-tracer.js # {chromote}   JS info      11:09:58.53 shinytest2; jQuery not found # {chromote}   JS info      11:09:58.53 shinytest2; Loaded # {shinytest2} R  info      11:09:58.54 Waiting until Shiny app starts # {chromote}   JS info      11:09:58.61 shinytest2; jQuery found # {chromote}   JS info      11:09:58.61 shinytest2; Waiting for shiny session to connect # {chromote}   JS websocket 11:09:58.73 send {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {chromote}   JS websocket 11:09:58.78 recv {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {chromote}   JS info      11:09:58.78 shinytest2; Connected # {chromote}   JS info      11:09:58.78 shinytest2; Ready # {chromote}   JS websocket 11:09:58.85 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"busy\":\"busy\"} # {chromote}   JS info      11:09:58.85 shinytest2; shiny:busy # {chromote}   JS websocket 11:09:58.86 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.86 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shinytest2} R  info      11:09:58.87 Shiny app started # {shinytest2} R  info      11:09:59.07 Setting inputs: 'bins' # {chromote}   JS websocket 11:09:59.08 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"busy\":\"idle\"} # {chromote}   JS info      11:09:59.08 shinytest2; shiny:idle # {chromote}   JS websocket 11:09:59.08 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS info      11:09:59.08 shinytest2; shiny:value distPlot # {chromote}   JS info      11:09:59.08 shinytest2; inputQueue: adding bins # {chromote}   JS info      11:09:59.09 shinytest2; inputQueue: flushing bins # {chromote}   JS websocket 11:09:59.10 send {\"method\":\"update\",\"data\":{\"bins\":20}} # {chromote}   JS websocket 11:09:59.11 recv {\"progress\":{\"type\":\"binding\",|truncated # {chromote}   JS websocket 11:09:59.11 recv {\"busy\":\"busy\"} # {chromote}   JS info      11:09:59.11 shinytest2; shiny:busy # {chromote}   JS websocket 11:09:59.12 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:59.14 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.18 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.19 recv {\"busy\":\"idle\"} # {chromote}   JS info      11:09:59.19 shinytest2; shiny:idle # {chromote}   JS websocket 11:09:59.21 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS info      11:09:59.21 shinytest2; shiny:value distPlot # {shinytest2} R  info      11:09:59.21 Finished setting inputs. Timedout: FALSE # {shinytest2} R  info      11:09:59.21 Getting all values # {shiny}      R  error     ----------- Loading required package: shiny # {shiny}      R  error     ----------- Running application in test mode. # {shiny}      R  error     ----------- # {shiny}      R  error     ----------- Listening on http://127.0.0.1:1505 # {shiny}      R  error     ----------- SEND {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {shiny}      R  error     ----------- RECV {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\"|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"busy\"} # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\"|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"idle\"} # {shiny}      R  error     ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {shiny}      R  error     ----------- RECV {\"method\":\"update\",\"data\":{\"bins\":20}} # {shiny}      R  error     ----------- SEND {\"progress\":{\"type\":\"binding\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"busy\"} # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"idle\"} # {shiny}      R  error     ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":{|truncated  # The log that is returned is a `data.frame()`. log <- app$get_logs() tibble::glimpse(log) #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, … #> $ timestamp <dttm> 2022-03-16 11:09:57, 2022-03-16 11:09:57, 2022-03-16 11:09:… #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shi… #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"inf… #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Cre…  # It may be filtered to find desired logs subset(log, level == \"websocket\") # {chromote}   JS websocket 11:09:58.73 send {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {chromote}   JS websocket 11:09:58.78 recv {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"busy\":\"busy\"} # {chromote}   JS websocket 11:09:58.86 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.86 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"busy\":\"idle\"} # {chromote}   JS websocket 11:09:59.08 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS websocket 11:09:59.10 send {\"method\":\"update\",\"data\":{\"bins\":20}} # {chromote}   JS websocket 11:09:59.11 recv {\"progress\":{\"type\":\"binding\",|truncated # {chromote}   JS websocket 11:09:59.11 recv {\"busy\":\"busy\"} # {chromote}   JS websocket 11:09:59.12 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:59.14 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.18 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.19 recv {\"busy\":\"idle\"} # {chromote}   JS websocket 11:09:59.21 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-log-message-","dir":"Reference","previous_headings":"","what":"Method log_message()","title":"Drive a Shiny application — AppDriver","text":"Add message shinytest2 log.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-30","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$log_message(message)"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"arguments-22","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drive a Shiny application — AppDriver","text":"message Single message store log","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-30","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) app$log_message(\"Setting bins to smaller value\") app$set_inputs(bins = 10) app$get_logs() }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"method-stop-","dir":"Reference","previous_headings":"","what":"Method stop()","title":"Drive a Shiny application — AppDriver","text":"Stop Shiny application driver method stops known processes: Shiny application background R process, background R process hosting Shiny application, Chromote Session instance. stop shiny application return value $stop(), see shiny::stopApp(). useful testing return context information. Typically, can paired button clicked call shiny::stopApp(info) return info test app back main R session.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"usage-31","dir":"Reference","previous_headings":"","what":"Usage","title":"Drive a Shiny application — AppDriver","text":"","code":"AppDriver$stop()"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"returns-15","dir":"Reference","previous_headings":"","what":"Returns","title":"Drive a Shiny application — AppDriver","text":"result background process Shiny application already terminated.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"examples-31","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"\\dontrun{ rlang::check_installed(\"reactlog\")  library(shiny) shiny_app <- shinyApp(   ui = fluidPage(     actionButton(\"button\", \"Stop app and return Reactlog\"),     \"Click count:\", textOutput(\"count\")   ),   server = function(input, output) {     output$count <- renderText({ input$button })     observe({       req(input$button)       stopApp(shiny::reactlog())     })   } )  app <- AppDriver$new(   shiny_app,   # Enable reactlog in background R session   options = list(shiny.reactlog = TRUE) ) app$click(\"button\") rlog <- app$stop() str(head(rlog, 2)) #> List of 2 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r3\" #> ..$ label  : chr \"Theme Counter\" #> ..$ type   : chr \"reactiveVal\" #> ..$ value  : chr \" num 0\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r4\" #> ..$ label  : chr \"output$count\" #> .. ..- attr(*, \"srcref\")= int [1:6] 7 32 7 45 32 45 #> .. ..- attr(*, \"srcfile\")= chr \"\" #> ..$ type   : chr \"observer\" #> ..$ value  : chr \" NULL\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 }"},{"path":"https://rstudio.github.io/shinytest2/reference/AppDriver.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drive a Shiny application — AppDriver","text":"","code":"## ------------------------------------------------ ## Method `AppDriver$new` ## ------------------------------------------------  if (FALSE) { # Create an AppDriver from the Shiny app in the current directory app <- AppDriver()  # Create an AppDriver object from a different Shiny app directory example_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver(example_app)  # Expect consistent inital values app$expect_values() }  ## ------------------------------------------------ ## Method `AppDriver$view` ## ------------------------------------------------  if (FALSE) { # Open app in Chrome app$view() }  ## ------------------------------------------------ ## Method `AppDriver$click` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  tmpfile <- write.csv(cars, \"cars.csv\") app$upload_file(file1 = tmpfile) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }  ## ------------------------------------------------ ## Method `AppDriver$set_inputs` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path) cat(app$get_text(\"#view\")) app$set_inputs(dataset = \"cars\", obs = 6) app$click(\"update\") cat(app$get_text(\"#view\")) }  ## ------------------------------------------------ ## Method `AppDriver$upload_file` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/09_upload\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save example file tmpfile <- tempfile(fileext = \".csv\") write.csv(cars, tmpfile, row.names = FALSE)  # Upload file to input named: file1 app$upload_file(file1 = tmpfile) }  ## ------------------------------------------------ ## Method `AppDriver$expect_values` ## ------------------------------------------------  if (FALSE) { library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Snapshot all known values app$expect_values()  # Snapshot only `export` values app$expect_values(export = TRUE)  # Snapshot values `\"A\"` from `input` and `\"C\"` from `output` app$expect_values(input = \"A\", output = \"C\") }  ## ------------------------------------------------ ## Method `AppDriver$get_value` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path) # Retrieve a single value app$get_value(output = \"caption\") #> [1] \"mpg ~ cyl\" # Equivalent code using `$get_values()` app$get_values(output = \"caption\")$output$caption #> [1] \"mpg ~ cyl\" }  ## ------------------------------------------------ ## Method `AppDriver$get_values` ## ------------------------------------------------  if (FALSE) { library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Pythagorean theorem\"),     numericInput(\"A\", \"A\", 3),     numericInput(\"B\", \"B\", 4),     verbatimTextOutput(\"C\"),   ),   function(input, output) {     a_squared <- reactive({ req(input$A); input$A * input$A })     b_squared <- reactive({ req(input$B); input$B * input$B })     c_squared <- reactive({ a_squared() + b_squared() })     c_value <- reactive({ sqrt(c_squared()) })     output$C <- renderText({ c_value() })      exportTestValues(       a_squared = { a_squared() },       b_squared = { b_squared() },       c_squared = { c_squared() }     )   } )  app <- AppDriver$new(shiny_app)  # Show all known values str(app$get_values()) #> List of 3 #> $ input :List of 2 #> ..$ A: int 3 #> ..$ B: int 4 #> $ output:List of 1 #> ..$ C: chr \"5\" #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get only `export` values str(app$get_values(export = TRUE)) #> List of 1 #> $ export:List of 3 #> ..$ a_squared: int 9 #> ..$ b_squared: int 16 #> ..$ c_squared: int 25  # Get values `\"A\"` from `input` and `\"C\"` from `output` str(app$get_values(input = \"A\", output = \"C\")) #> List of 2 #> $ input :List of 1 #> ..$ A: int 3 #> $ output:List of 1 #> ..$ C: chr \"5\" }  ## ------------------------------------------------ ## Method `AppDriver$expect_download` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Save snapshot of rock.csv as 001.download # Save snapshot value of `rock.csv` to capture default file name app$expect_download(\"downloadData\", compare = testthat::compare_file_text) }  ## ------------------------------------------------ ## Method `AppDriver$get_download` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/10_download\", package = \"shiny\") app <- AppDriver$new(app_path)  # Get rock.csv as a tempfile app$get_download(\"downloadData\") #> [1] \"/TEMP/PATH/rock.csv\"  # Get rock.csv as a \"./myfile.csv\" app$get_download(\"downloadData\", filename = \"./myfile.csv\") #> [1] \"./myfile.csv\" }  ## ------------------------------------------------ ## Method `AppDriver$expect_text` ## ------------------------------------------------  if (FALSE) { hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  # Make a snapshot of `\"Hello Shiny!\"` app$expect_text(\"h2\") }  ## ------------------------------------------------ ## Method `AppDriver$get_text` ## ------------------------------------------------  if (FALSE) { hello_app <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(hello_app)  app$get_text(\"h2\") #> [1] \"Hello Shiny!\" }  ## ------------------------------------------------ ## Method `AppDriver$expect_html` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/04_mpg\", package = \"shiny\") app <- AppDriver$new(app_path) # Save a snapshot of the `caption` output app$expect_html(\"#caption\") }  ## ------------------------------------------------ ## Method `AppDriver$get_html` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/03_reactivity\", package = \"shiny\") app <- AppDriver$new(app_path, check_names = FALSE) app$set_inputs(caption = \"Custom value!\") cat(app$get_html(\".shiny-input-container\")[1]) #> <div class=\"form-group shiny-input-container\"> #>   <label class=\"control-label\" id=\"caption-label\" for=\"caption\">Caption:<\/label> #>   <input id=\"caption\" type=\"text\" class=\"form-control shiny-bound-input\" value=\"Data Summary\"> #> <\/div> ## ^^ No update to the DOM of `caption` }  ## ------------------------------------------------ ## Method `AppDriver$expect_js` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/07_widgets\", package = \"shiny\") app <- AppDriver$new(app_path)  # Track how many clicks are given to `#update` button app$run_js(\"   window.test_counter = 0;   $('#update').click(() => window.test_counter++); \") app$set_inputs(obs = 20) # Click the update button, incrementing the counter app$click(\"update\") # Save a snapshot of number of clicks (1) app$expect_js(\"window.test_counter;\") }  ## ------------------------------------------------ ## Method `AppDriver$get_js` ## ------------------------------------------------  if (FALSE) { library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Execute JavaScript code in the app's browser app$get_js(\"1 + 1;\") #> [1] 2  # Execute a JavaScript Promise. Return the resolved value. app$get_js(\"   new Promise((resolve) => {     setTimeout(() => resolve(1 + 1), 1000)   }).   then((value) => value + 1); \") #> [1] 3  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$get_js(js_txt) #> [1] \"127.0.0.1\"  # With `glue::glue()` js_txt <- glue::glue_data(   lapply(     list(x = 40, y = 2),     jsonlite::toJSON,     auto_unbox = TRUE   ),   .open = \"<\", .close = \">\",   \"let answer = function(a, b) {\\n\",   \"  return a + b;\\n\",   \"};\\n\",   \"answer(<x>, <y>);\\n\" ) app$get_js(js_txt) #> [1] 42 }  ## ------------------------------------------------ ## Method `AppDriver$run_js` ## ------------------------------------------------  if (FALSE) { library(shiny) shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Get JavaScript answer from the app's browser app$get_js(\"1 + 1\") #> [1] 2 # Execute JavaScript code in the app's browser app$run_js(\"1 + 1\") # (Returns `app` invisibly)  # With escaped arguments loc_field <- \"hostname\" js_txt <- paste0(\"window.location[\", jsonlite::toJSON(loc_field, auto_unbox = TRUE), \"]\") app$run_js(js_txt) app$get_js(js_txt) #> [1] \"127.0.0.1\" }  ## ------------------------------------------------ ## Method `AppDriver$expect_screenshot` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path, variant = platform_variant())  # Expect a full size screenshot app$expect_screenshot()  # Very brittle test app$expect_screenshot(selector = \"#distPlot\") }  ## ------------------------------------------------ ## Method `AppDriver$get_screenshot` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  # Display in viewer app$get_screenshot()  # Update bins then display `\"disPlot\"` in viewer app$set_inputs(bins = 10) app$get_screenshot(selector = \"#distPlot\")  # Save screenshot to file and view it tmpfile <- tempfile(fileext = \".png\") app$get_screenshot(tmpfile) showimage::show_image(tmpfile) }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_idle` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path)  pre_value <- app$get_value(output = \"distPlot\") # Update bins value app$set_inputs(bins = 10, wait_ = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value)  # --------------------- ## Change the screen size to trigger a plot update pre_value <- app$get_value(output = \"distPlot\") app$set_window_size(height = 1080, width = 1920, wait = FALSE) middle_value <- app$get_value(output = \"distPlot\") app$wait_for_idle() post_value <- app$get_value(output = \"distPlot\")  # No guarantee that these values are different identical(pre_value, middle_value) # Will not be equal identical(pre_value, post_value) }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_value` ## ------------------------------------------------  if (FALSE) { library(shiny) shiny_app <- shinyApp(   fluidPage(     h1(\"Dynamic output\"),     actionButton(\"display\", \"Display UI\"),     uiOutput(\"dym1\"),   ),   function(input, output) {     output$dym1 <- renderUI({       req(input$display)       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider1\", \"Slider #1\", 0, 100, 25),         uiOutput(\"dym2\")       )     })     output$dym2 <- renderUI({       Sys.sleep(runif(1, max = 2)) # Artificial calculations       tagList(         sliderInput(\"slider2\", \"Slider #2\", 0, 100, 50),         \"Total:\", verbatimTextOutput(\"total\")       )     })     output$total <- renderText({       req(input$slider1, input$slider2)       input$slider1 + input$slider2     })   } )  app <- AppDriver$new(shiny_app)  # Create UI / output values app$click(\"display\") # Wait for total to be calculated (or have a non-NULL value) new_total_value <- app$wait_for_value(output = \"total\") #> [1] \"75\" app$get_value(output = \"total\") #> [1] \"75\" }  ## ------------------------------------------------ ## Method `AppDriver$wait_for_js` ## ------------------------------------------------  if (FALSE) { shiny_app <- shinyApp(h1(\"Empty App\"), function(input, output) { }) app <- AppDriver$new(shiny_app)  # Contrived example: # Wait until `Date.now()` returns a number that ends in a 5. (0 - 10 seconds) system.time(   app$wait_for_js(\"Math.floor((Date.now() / 1000) % 10) == 5;\") )  ## A second example where we run the contents of a JavaScript file ## and use the result to wait for a condition app$run_js(file = \"complicated_file.js\") app$wait_for_js(\"complicated_condition();\") }  ## ------------------------------------------------ ## Method `AppDriver$expect_unique_names` ## ------------------------------------------------  if (FALSE) { shiny_app <- shinyApp(   ui = fluidPage(     # Duplicate input IDs: `\"text\"`     textInput(\"text\", \"Text 1\"),     textInput(\"text\", \"Text 2\")   ),   server = function(input, output) {     # empty   } ) # Initial checking for unique names (default behavior) app <- AppDriver$new(shiny_app, check_names = TRUE) #> Warning: #> ! Shiny inputs should have unique HTML id values. #> ℹ The following HTML id values are not unique: #> • text  # Manually assert that all names are unique app <- AppDriver$new(shiny_app, check_names = FALSE) app$expect_unique_names() #> Error: `app_check_unique_names(self, private)` threw an unexpected warning. #> Message: ! Shiny inputs should have unique HTML id values. #> ℹ The following HTML id values are not unique: #>   • text #> Class:   rlang_warning/warning/condition }  ## ------------------------------------------------ ## Method `AppDriver$get_dir` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) identical(app$get_dir(), app_path) #> [1] TRUE }  ## ------------------------------------------------ ## Method `AppDriver$get_url` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) browseURL(app$get_url()) }  ## ------------------------------------------------ ## Method `AppDriver$get_window_size` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) app$get_window_size() #> $width #> [1] 992 #> #> $height #> [1] 1323 }  ## ------------------------------------------------ ## Method `AppDriver$set_window_size` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") # Set init window size app <- AppDriver$new(app_path, height = 1400, width = 1000)  app$get_window_size() #> $width #> [1] 1000 #> #> $height #> [1] 1400  # Manually set the window size app$set_window_size(height = 1080, width = 1920) app$get_window_size() #> $width #> [1] 1920 #> #> $height #> [1] 1080 }  ## ------------------------------------------------ ## Method `AppDriver$get_chromote_session` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) b <- app$get_chromote_session() b$Runtime$evaluate(\"1 + 1\") #> $result #> $result$type #> [1] \"number\" #> #> $result$value #> [1] 2 #> #> $result$description #> [1] \"2\" }  ## ------------------------------------------------ ## Method `AppDriver$get_variant` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\")  app <- AppDriver$new(app_path) app$get_variant() #> NULL  app <- AppDriver$new(app_path, variant = platform_variant()) app$get_variant() #> [1] \"mac-4.1\" }  ## ------------------------------------------------ ## Method `AppDriver$get_logs` ## ------------------------------------------------  if (FALSE) { app <- AppDriver$new(system.file(\"examples/01_hello\", package = \"shiny\")) app$get_logs() # {shinytest2} R  info  11:15:20.11 Start AppDriver initialization # {shinytest2} R  info  11:15:20.11 Starting Shiny app # {shinytest2} R  info  11:15:20.99 Creating new chromote session # {shinytest2} R  info  11:15:21.14 Navigating to Shiny app # {shinytest2} R  info  11:15:21.27 Injecting shiny-tracer.js # {chromote}   JS info  11:15:21.28 shinytest2; jQuery not found # {chromote}   JS info  11:15:21.28 shinytest2; Loaded # {shinytest2} R  info  11:15:21.28 Waiting until Shiny app starts # {chromote}   JS info  11:15:21.35 shinytest2; jQuery found # {chromote}   JS info  11:15:21.35 shinytest2; Waiting for shiny session to connect # {chromote}   JS info  11:15:21.57 shinytest2; Connected # {chromote}   JS info  11:15:21.57 shinytest2; Ready # {chromote}   JS info  11:15:21.65 shinytest2; shiny:busy # {shinytest2} R  info  11:15:21.65 Shiny app started # {chromote}   JS info  11:15:21.88 shinytest2; shiny:idle # {chromote}   JS info  11:15:21.88 shinytest2; shiny:value distPlot # {shiny}      R  error ----------- Loading required package: shiny # {shiny}      R  error ----------- Running application in test mode. # {shiny}      R  error ----------- # {shiny}      R  error ----------- Listening on http://127.0.0.1:42558   # To capture all websocket traffic, set `options = list(shiny.trace = TRUE)` app <- AppDriver$new(   system.file(\"examples/01_hello\", package = \"shiny\"),   options = list(shiny.trace = TRUE) ) app$get_logs() # (long output lines have been truncated) # {shinytest2} R  info      11:09:57.43 Start AppDriver initialization # {shinytest2} R  info      11:09:57.43 Starting Shiny app # {shinytest2} R  info      11:09:58.27 Creating new chromote session # {shinytest2} R  info      11:09:58.40 Navigating to Shiny app # {shinytest2} R  info      11:09:58.53 Injecting shiny-tracer.js # {chromote}   JS info      11:09:58.53 shinytest2; jQuery not found # {chromote}   JS info      11:09:58.53 shinytest2; Loaded # {shinytest2} R  info      11:09:58.54 Waiting until Shiny app starts # {chromote}   JS info      11:09:58.61 shinytest2; jQuery found # {chromote}   JS info      11:09:58.61 shinytest2; Waiting for shiny session to connect # {chromote}   JS websocket 11:09:58.73 send {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {chromote}   JS websocket 11:09:58.78 recv {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {chromote}   JS info      11:09:58.78 shinytest2; Connected # {chromote}   JS info      11:09:58.78 shinytest2; Ready # {chromote}   JS websocket 11:09:58.85 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"busy\":\"busy\"} # {chromote}   JS info      11:09:58.85 shinytest2; shiny:busy # {chromote}   JS websocket 11:09:58.86 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.86 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shinytest2} R  info      11:09:58.87 Shiny app started # {shinytest2} R  info      11:09:59.07 Setting inputs: 'bins' # {chromote}   JS websocket 11:09:59.08 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"busy\":\"idle\"} # {chromote}   JS info      11:09:59.08 shinytest2; shiny:idle # {chromote}   JS websocket 11:09:59.08 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS info      11:09:59.08 shinytest2; shiny:value distPlot # {chromote}   JS info      11:09:59.08 shinytest2; inputQueue: adding bins # {chromote}   JS info      11:09:59.09 shinytest2; inputQueue: flushing bins # {chromote}   JS websocket 11:09:59.10 send {\"method\":\"update\",\"data\":{\"bins\":20}} # {chromote}   JS websocket 11:09:59.11 recv {\"progress\":{\"type\":\"binding\",|truncated # {chromote}   JS websocket 11:09:59.11 recv {\"busy\":\"busy\"} # {chromote}   JS info      11:09:59.11 shinytest2; shiny:busy # {chromote}   JS websocket 11:09:59.12 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:59.14 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.18 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.19 recv {\"busy\":\"idle\"} # {chromote}   JS info      11:09:59.19 shinytest2; shiny:idle # {chromote}   JS websocket 11:09:59.21 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS info      11:09:59.21 shinytest2; shiny:value distPlot # {shinytest2} R  info      11:09:59.21 Finished setting inputs. Timedout: FALSE # {shinytest2} R  info      11:09:59.21 Getting all values # {shiny}      R  error     ----------- Loading required package: shiny # {shiny}      R  error     ----------- Running application in test mode. # {shiny}      R  error     ----------- # {shiny}      R  error     ----------- Listening on http://127.0.0.1:1505 # {shiny}      R  error     ----------- SEND {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {shiny}      R  error     ----------- RECV {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\"|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"busy\"} # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\"|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"idle\"} # {shiny}      R  error     ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {shiny}      R  error     ----------- RECV {\"method\":\"update\",\"data\":{\"bins\":20}} # {shiny}      R  error     ----------- SEND {\"progress\":{\"type\":\"binding\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"busy\"} # {shiny}      R  error     ----------- SEND {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"recalculating\":{\"name\":\"distPlot\",|truncated # {shiny}      R  error     ----------- SEND {\"busy\":\"idle\"} # {shiny}      R  error     ----------- SEND {\"errors\":{},\"values\":{\"distPlot\":{|truncated  # The log that is returned is a `data.frame()`. log <- app$get_logs() tibble::glimpse(log) #> $ workerid  <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, … #> $ timestamp <dttm> 2022-03-16 11:09:57, 2022-03-16 11:09:57, 2022-03-16 11:09:… #> $ location  <chr> \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shinytest2\", \"shi… #> $ level     <chr> \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"info\", \"inf… #> $ message   <chr> \"Start AppDriver initialization\", \"Starting Shiny app\", \"Cre…  # It may be filtered to find desired logs subset(log, level == \"websocket\") # {chromote}   JS websocket 11:09:58.73 send {\"method\":\"init\",\"data\":{\"bins\":30,|truncated # {chromote}   JS websocket 11:09:58.78 recv {\"config\":{\"workerId\":\"\",\"sessionId\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.85 recv {\"busy\":\"busy\"} # {chromote}   JS websocket 11:09:58.86 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:58.86 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.08 recv {\"busy\":\"idle\"} # {chromote}   JS websocket 11:09:59.08 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated # {chromote}   JS websocket 11:09:59.10 send {\"method\":\"update\",\"data\":{\"bins\":20}} # {chromote}   JS websocket 11:09:59.11 recv {\"progress\":{\"type\":\"binding\",|truncated # {chromote}   JS websocket 11:09:59.11 recv {\"busy\":\"busy\"} # {chromote}   JS websocket 11:09:59.12 recv {\"custom\":{\"showcase-src\":{\"srcref\":|truncated # {chromote}   JS websocket 11:09:59.14 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.18 recv {\"recalculating\":{\"name\":\"distPlot\",|truncated # {chromote}   JS websocket 11:09:59.19 recv {\"busy\":\"idle\"} # {chromote}   JS websocket 11:09:59.21 recv {\"errors\":{},\"values\":{\"distPlot\":{|truncated }  ## ------------------------------------------------ ## Method `AppDriver$log_message` ## ------------------------------------------------  if (FALSE) { app_path <- system.file(\"examples/01_hello\", package = \"shiny\") app <- AppDriver$new(app_path) app$log_message(\"Setting bins to smaller value\") app$set_inputs(bins = 10) app$get_logs() }  ## ------------------------------------------------ ## Method `AppDriver$stop` ## ------------------------------------------------  if (FALSE) { rlang::check_installed(\"reactlog\")  library(shiny) shiny_app <- shinyApp(   ui = fluidPage(     actionButton(\"button\", \"Stop app and return Reactlog\"),     \"Click count:\", textOutput(\"count\")   ),   server = function(input, output) {     output$count <- renderText({ input$button })     observe({       req(input$button)       stopApp(shiny::reactlog())     })   } )  app <- AppDriver$new(   shiny_app,   # Enable reactlog in background R session   options = list(shiny.reactlog = TRUE) ) app$click(\"button\") rlog <- app$stop() str(head(rlog, 2)) #> List of 2 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r3\" #> ..$ label  : chr \"Theme Counter\" #> ..$ type   : chr \"reactiveVal\" #> ..$ value  : chr \" num 0\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 #> $ :List of 7 #> ..$ action : chr \"define\" #> ..$ reactId: chr \"r4\" #> ..$ label  : chr \"output$count\" #> .. ..- attr(*, \"srcref\")= int [1:6] 7 32 7 45 32 45 #> .. ..- attr(*, \"srcfile\")= chr \"\" #> ..$ type   : chr \"observer\" #> ..$ value  : chr \" NULL\" #> ..$ session: chr \"bdc7417f2fc8c84fc05c9518e36fdc44\" #> ..$ time   : num 1.65e+09 }"},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Load the Shiny application's support environment — load_app_env","title":"Load the Shiny application's support environment — load_app_env","text":"Executes ./R files global.R current environment. useful wanting access functions values created ./R folder testing purposes.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load the Shiny application's support environment — load_app_env","text":"","code":"load_app_env(   app_dir = \"../../\",   renv = rlang::caller_env(),   globalrenv = rlang::caller_env() )"},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load the Shiny application's support environment — load_app_env","text":"app_dir base directory Shiny application. renv environmeny files R/ directory evaluated. globalrenv environment global.R evaluated. NULL, global.R evaluated .","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/load_app_env.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load the Shiny application's support environment — load_app_env","text":"Loading files automatically performed test_app() must called ./tests/testthat/setup.R access support file objects desired.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":null,"dir":"Reference","previous_headings":"","what":"Migrate shinytest tests — migrate_from_shinytest","title":"Migrate shinytest tests — migrate_from_shinytest","text":"function migrate standard shinytest test files new shinytest2 + testthat ed 3 snapshot format.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Migrate shinytest tests — migrate_from_shinytest","text":"","code":"migrate_from_shinytest(   app_dir,   ...,   clean = TRUE,   include_expect_screenshot = missing_arg(),   quiet = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Migrate shinytest tests — migrate_from_shinytest","text":"app_dir Directory containing Shiny application Shiny Rmd file ... Must empty. Allows parameter expansion. clean TRUE, shinytest test directory runner deleted migration use shinytest2. include_expect_screenshot TRUE, ShinyDriver$snapshot() turn AppDriver$expect_values() AppDriver$expect_screenshot(). FALSE, ShinyDriver$snapshot() turn AppDriver$expect_values(). missing, include_expect_screenshot behave FALSE shinytest::testApp(compareImages = FALSE) ShinyDriver$snapshotInit(screenshot = FALSE) called. quiet Logical determines migration information steps printed console.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Migrate shinytest tests — migrate_from_shinytest","text":"Invisible TRUE","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/migrate_from_shinytest.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Migrate shinytest tests — migrate_from_shinytest","text":"shinytest file contents traversed converted new shinytest2 format. shinytest code can directly seen code, converted.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":null,"dir":"Reference","previous_headings":"","what":"Platform specific variant — platform_variant","title":"Platform specific variant — platform_variant","text":"Returns string used within testthat's' snapshot testing. Currently, Operating System R Version (major, minor, patch version) returned.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Platform specific variant — platform_variant","text":"","code":"platform_variant(..., os_name = TRUE, r_version = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Platform specific variant — platform_variant","text":"... Must empty. Allows parameter expansion. os_name TRUE, include OS name output r_version TRUE, include major minor version R version, patch version","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/platform_variant.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Platform specific variant — platform_variant","text":"information needed future distinguish standard testing environments, function updated accordingly.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Launch test event recorder for a Shiny app — record_test","title":"Launch test event recorder for a Shiny app — record_test","text":"recording completed, create append new shinytest2 test testthat test_file.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Launch test event recorder for a Shiny app — record_test","text":"","code":"record_test(   app = \".\",   ...,   name = NULL,   seed = NULL,   load_timeout = NULL,   shiny_args = list(),   test_file = \"test-shinytest2.R\",   open_test_file = rlang::is_interactive(),   allow_no_input_binding = NULL,   run_test = TRUE )"},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Launch test event recorder for a Shiny app — record_test","text":"app AppDriver object, path Shiny application. ... Must empty. Allows parameter expansion. name Name provided AppDriver. value unique tests within test file. unique, different expect methods may overwrite . seed random seed set running app. seed also used test script. load_timeout Maximum time wait Shiny application load, milliseconds. value provided, saved test script. shiny_args list options pass runApp(). value provided, saved test script. test_file Base file name testthat test file. open_test_file TRUE, test file opened editor via file.edit() executing. allow_no_input_binding value controls events without input bindings recorded. TRUE, events without input bindings recorded. FALSE, events without input bindings recorded. NULL (default), updated input corresponding input, modal dialog shown asking unbound input events recorded. See AppDriver$set_inputs() information. run_test TRUE, test_file executed saving recording.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"uploading-files","dir":"Reference","previous_headings":"","what":"Uploading files","title":"Launch test event recorder for a Shiny app — record_test","text":"Files uploaded Shiny app must located somewhere within tests/testthat subdirectory available via system.file(). Files uploaded recording valid path warning inserted code. Please fix file path moving file tests/testthat subdirectory using system.file(). fixing path, remove line warning code.","code":""},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/record_test.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Launch test event recorder for a Shiny app — record_test","text":"","code":"if (FALSE) { record_test(\"path/to/app\") }"},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":null,"dir":"Reference","previous_headings":"","what":"Register an input processor for the test recorder — register_input_processor","title":"Register an input processor for the test recorder — register_input_processor","text":"register_input_processor() registers input processor used test recorder. input processor function take one parameter, value, return string R code returns desired value. get_input_processors() returns named list registered input processor functions.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Register an input processor for the test recorder — register_input_processor","text":"","code":"register_input_processor(input_type, processor)  get_input_processors()"},{"path":"https://rstudio.github.io/shinytest2/reference/register_input_processor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Register an input processor for the test recorder — register_input_processor","text":"input_type name input type, example, \"mypkg.numberinput\". processor input processor function.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Shiny applications with testthat — test_app","title":"Test Shiny applications with testthat — test_app","text":"helper method wraps around testthat::test_dir() test Shiny application Shiny runtime document.  similar testthat::test_check() tests R package app.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Shiny applications with testthat — test_app","text":"","code":"test_app(app_dir = missing_arg(), ..., check_setup = TRUE)"},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Shiny applications with testthat — test_app","text":"app_dir base directory Shiny application. app_dir missing test_app() called within ./tests/testthat.R file, parent directory (\"../\") used. Otherwise, default path \".\" used. ... Parameters passed testthat::test_dir() check_setup TRUE, app checked presence ./tests/testthat/setup.R. file must contain call load_app_env().","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test Shiny applications with testthat — test_app","text":"setting tests app, Example usage:","code":"## Interactive usage # Test Shiny app in current working directory shinytest2::test_app()  # Test Shiny app in another directory path_to_app <- \"path/to/app\" shinytest2::test_app(path_to_app)  ## File: ./tests/testthat.R # Will find Shiny app in \"../\" shinytest2::test_app()  ## File: ./tests/testthat/test-shinytest2.R # Test a shiny application within your own {testthat} code test_that(\"Testing a Shiny app in a package\", {   shinytest2::test_app(path_to_app) })"},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"uploading-files","dir":"Reference","previous_headings":"","what":"Uploading files","title":"Test Shiny applications with testthat — test_app","text":"testing application, non-temp files uploaded located ./tests/testthat directory. allows tests portable self contained. recording test record_test(), every uploaded file located outside ./tests/testthat, warning thrown. file path fixed, may remove warning statement.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/test_app.html","id":"different-ways-to-test","dir":"Reference","previous_headings":"","what":"Different ways to test","title":"Test Shiny applications with testthat — test_app","text":"test_app() opinionated testing function execute testthat tests ./tests/testthat folder. (rare reason) non-testthat tests execute, can call shiny::runTests(). method generically run test runners associated tests.","code":"# Execute a single Shiny app's {testthat} file such as `./tests/testthat/test-shinytest2.R` test_app(filter = \"shinytest2\")  # Execute all {testthat} tests test_app()  # Execute all tests for all test runners shiny::runTests()"},{"path":[]},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":null,"dir":"Reference","previous_headings":"","what":"Use shinytest2 with your Shiny application — use_shinytest2","title":"Use shinytest2 with your Shiny application — use_shinytest2","text":"Use shinytest2 Shiny application","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use shinytest2 with your Shiny application — use_shinytest2","text":"","code":"use_shinytest2(   app_dir = \".\",   runner = TRUE,   setup = TRUE,   ignore = TRUE,   package = TRUE,   ...,   quiet = FALSE,   overwrite = FALSE )  use_shinytest2_test(   app_dir = \".\",   open = rlang::is_interactive(),   quiet = FALSE,   overwrite = FALSE )"},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use shinytest2 with your Shiny application — use_shinytest2","text":"app_dir base directory Shiny application runner TRUE, creates shinytest2 test runner ./tests/testthat.R setup TRUE, creates setup file called ./tests/testthat/setup.R containing call load_app_env() ignore TRUE, adds entries .Rbuildignore .gitignore ignore new debug screenshots. (*_.new.png) package TRUE, adds shinytest2 Suggests DESCRIPTION file. ... Must empty. Allows parameter expansion. quiet TRUE, console output suppressed. overwrite TRUE, test file test runner overwritten. open TRUE, test file opened editor via file.edit() saving.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Use shinytest2 with your Shiny application — use_shinytest2","text":"use_shinytest2: usethis-style method initializes many different useful features using shinytest2: Creates shinytest2 test runner ./tests/testthat.R. file contain call test_app() set proper testing environment Shiny application, enable testthat edition 3, execute testthat tests. Add entry ./Rbuildignore (exists) .gitignore ignore new debug screenshots. (*_.new.png) Adds shinytest Suggests packages DESCRIPTION file (exists). use_shinytest2_test: Creates test file called ./tests/testthat/test-shinytest2.R. default, file's template test initialize Shiny application expect initial values. method also set test runner exist.","code":""},{"path":"https://rstudio.github.io/shinytest2/reference/use_shinytest2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use shinytest2 with your Shiny application — use_shinytest2","text":"","code":"# Set up shinytest2 testing configs if (FALSE) use_shinytest2() # Set up a shinytest2 test if (FALSE) use_shinytest2_test()"},{"path":"https://rstudio.github.io/shinytest2/news/index.html","id":"shinytest2-0009000","dir":"Changelog","previous_headings":"","what":"shinytest2 0.0.0.9000","title":"shinytest2 0.0.0.9000","text":"Added NEWS.md file track changes package.","code":""}]
